"use strict";var __decorate=this&&this.__decorate||function(a,b,f,g){var l,h=arguments.length,j=3>h?b:null===g?g=Object.getOwnPropertyDescriptor(b,f):g;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)j=Reflect.decorate(a,b,f,g);else for(var m=a.length-1;0<=m;m--)(l=a[m])&&(j=(3>h?l(j):3<h?l(b,f,j):l(b,f))||j);return 3<h&&j&&Object.defineProperty(b,f,j),j},__metadata=this&&this.__metadata||function(a,b){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(a,b)},__awaiter=this&&this.__awaiter||function(a,b,f,g){return new(f||(f=Promise))(function(h,j){function l(o){try{n(g.next(o))}catch(p){j(p)}}function m(o){try{n(g["throw"](o))}catch(p){j(p)}}function n(o){o.done?h(o.value):new f(function(p){p(o.value)}).then(l,m)}n((g=g.apply(a,b)).next())})};const core_1=require("@angular/core"),mcds_client_1=require("../mcds/mcds.client"),util=require("errisy-util"),errisy_bindable_1=require("errisy-bindable"),errisy_color_1=require("errisy-color"),settings_1=require("../mcds/settings");let FeatureTypeManagement=class{constructor(b,f){this.mcds=b,this.changeDetectorRef=f}ngAfterViewInit(){return __awaiter(this,void 0,void 0,function*(){yield this.loadFeatureTypes(),this.changeDetectorRef.detectChanges()})}loadFeatureTypes(){return __awaiter(this,void 0,void 0,function*(){this.Status="Loading...",this.changeDetectorRef.detectChanges();let b=yield this.mcds.readFeatureTypesSetting(util.cookie.get("username"),util.cookie.get("password"));if(b&&"string"==typeof b)try{this.FeatureTypes=yield errisy_bindable_1.obs.unpack(b),this.Status="Loaded."}catch(f){this.FeatureTypes=new settings_1.FeatureTypes,this.Status="Created."}else this.FeatureTypes=new settings_1.FeatureTypes,this.Status="Created."})}Save(){return __awaiter(this,void 0,void 0,function*(){this.Status="Saving...",yield this.mcds.writeFeatureTypesSetting(util.cookie.get("username"),util.cookie.get("password"),errisy_bindable_1.obs.pack(this.FeatureTypes)),this.Status="Saved."})}addFeatureType(){let b=new settings_1.FeatureType;b.Type="New Site",this.FeatureTypes.Types.push(b)}removeFeatureType(b){let f=this.FeatureTypes.Types.indexOf(b);-1<f&&(this.FeatureTypes.Types.splice(f,1),this.selectedFeatureType==b&&this.selectFeatureType(void 0))}selectFeatureType(b){this.selectedFeatureType=b}complementColor(b){let f=errisy_color_1.Color.parse(b).complement().toHSV();return 20>f.S?(f.S=0,f.V=60<=f.V?100:0):(f.S=100,f.V=20>=f.V?0:100),f.A=1,f.toColor().toString()}};FeatureTypeManagement=__decorate([core_1.Component({selector:"feature-type",templateUrl:"management/featuretype.component.html",providers:[mcds_client_1.MCDSCore]}),__metadata("design:paramtypes",["function"==typeof(_a="undefined"!=typeof mcds_client_1.MCDSCore&&mcds_client_1.MCDSCore)&&_a||Object,core_1.ChangeDetectorRef])],FeatureTypeManagement),exports.FeatureTypeManagement=FeatureTypeManagement;var _a;