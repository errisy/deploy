"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},__extends=function(o,s){function l(){this.constructor=o}for(var g in s)s.hasOwnProperty(g)&&(o[g]=s[g]);o.prototype=null===s?Object.create(s):(l.prototype=s.prototype,new l)},__decorate=function(o,s,l,g){var O,u=arguments.length,m=3>u?s:null===g?g=Object.getOwnPropertyDescriptor(s,l):g;if("object"===("undefined"==typeof Reflect?"undefined":_typeof(Reflect))&&"function"==typeof Reflect.decorate)m=Reflect.decorate(o,s,l,g);else for(var S=o.length-1;0<=S;S--)(O=o[S])&&(m=(3>u?O(m):3<u?O(s,l,m):O(s,l))||m);return 3<u&&m&&Object.defineProperty(s,l,m),m},__metadata=function(o,s){if("object"===("undefined"==typeof Reflect?"undefined":_typeof(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(o,s)},__awaiter=function(o,s,l,g){return new(l||(l=Promise))(function(u,m){function O(C){try{D(g.next(C))}catch(B){m(B)}}function S(C){try{D(g["throw"](C))}catch(B){m(B)}}function D(C){C.done?u(C.value):new l(function(B){B(C.value)}).then(O,S)}D((g=g.apply(o,s)).next())})},__generator=function(o,s){function l(D){return function(C){return g([D,C])}}function g(D){if(m)throw new TypeError("Generator is already executing.");for(;u;)try{if(m=1,O&&(S=O[2&D[0]?"return":D[0]?"throw":"next"])&&!(S=S.call(O,D[1])).done)return S;switch((O=0,S)&&(D=[0,S.value]),D[0]){case 0:case 1:S=D;break;case 4:return u.label++,{value:D[1],done:!1};case 5:u.label++,O=D[1],D=[0];continue;case 7:D=u.ops.pop(),u.trys.pop();continue;default:if((S=u.trys,!(S=0<S.length&&S[S.length-1]))&&(6===D[0]||2===D[0])){u=0;continue}if(3===D[0]&&(!S||D[1]>S[0]&&D[1]<S[3])){u.label=D[1];break}if(6===D[0]&&u.label<S[1]){u.label=S[1],S=D;break}if(S&&u.label<S[2]){u.label=S[2],u.ops.push(D);break}S[2]&&u.ops.pop(),u.trys.pop();continue;}D=s.call(o,u)}catch(C){D=[6,C],O=0}finally{m=S=0}if(5&D[0])throw D[1];return{value:D[0]?D[1]:void 0,done:!0}}var m,O,S,u={label:0,sent:function(){if(1&S[0])throw S[1];return S[1]},trys:[],ops:[]};return{next:l(0),"throw":l(1),"return":l(2)}},EventService=function(){function o(s){this.Directives=s}return o.prototype.subscribe=function(s,l,g){this.subscribers||(this.subscribers={}),this.subscribers[s]||(this.subscribers[s]=[]),this.subscribers[s].push(new EventSubscriber(l,g))},o.prototype.unsubscribe=function(s,l){!this.subscribers||this.subscribers[s]&&(this.subscribers[s]=this.subscribers[s].filter(function(g){return g.disposable!==l}))},o.prototype.unsubscribeAll=function(s){if(this.subscribers)for(var l in this.subscribers)this.subscribers[l]=this.subscribers[l].filter(function(g){return g.disposable!==s})},o.prototype.emit=function(s,l,g){for(var u=[],m=3;m<arguments.length;m++)u[m-3]=arguments[m];if(this.subscribers&&this.subscribers[s]){var O=[],S=0;return this.subscribers[s].forEach(function(D){g&&D.disposable===l||!D.disposable.disposed&&(O.push(D),D.handler.apply(D.disposable,u),S+=1)}),this.subscribers[s]=O,S}},o}();exports.EventService=EventService;var EventSubscriber=function(){return function(s,l){this.disposable=s,this.handler=l}}(),EventStatus;(function(o){o[o.none=0]="none",o[o.before=1]="before",o[o.bindBeforeWithCheck=2]="bindBeforeWithCheck",o[o.after=3]="after",o[o.decorator=4]="decorator"})(EventStatus||(EventStatus={}));var util=function(){function o(){}return o.checkValidNumber=function(s,l){return"string"==typeof s&&/^(\d+(\.\d*|)|\.\d+)$/.test(s)?+s:"number"!=typeof s||Number.isNaN(s)?l:s},o.appendArrayDictionary=function(s,l){for(var g in l)s[g]||(s[g]=[]),o.appendArray(s[g],l[g]);return s},o.appendDictionary=function(s,l){if(!l)return s;for(var g in l)s[g]=l[g];return s},o.forOf=function(s,l){if(s&&l)for(var g in s)l(g,s[g])},o.reduceOf=function(s,l,g){if(!s||!l)return g;var u=g;for(var m in s)u=l(u,m,s[m]);return u},o}();util.appendArray=function(o,s){return s?(Array.prototype.push.apply(o,s),o):o},exports.util=util;var invokeStatus;(function(o){o[o.none=0]="none",o[o.invokeBefore=1]="invokeBefore",o[o.invokeAfter=2]="invokeAfter",o[o.invokeBeforeWithCheck=3]="invokeBeforeWithCheck",o[o.bindBefore=4]="bindBefore",o[o.bindBeforeWithCheckValidate=5]="bindBeforeWithCheckValidate",o[o.bindAfter=6]="bindAfter",o[o.updateOneWayToBefore=7]="updateOneWayToBefore",o[o.updateOneWayToAfter=8]="updateOneWayToAfter",o[o.updateOneWayToBeforeWithCheckValidate=9]="updateOneWayToBeforeWithCheckValidate",o[o.check=10]="check",o[o.validate=11]="validate",o[o.decorator=12]="decorator"})(invokeStatus||(invokeStatus={}));var Trigger=function(){function o(s,l){this.decorator=s,this.shouldCheck=l}return Object.defineProperty(o.prototype,"target",{get:function(){return this.decorator?this.decorator.target:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"key",{get:function(){return this.decorator?this.decorator.propertyKey:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"method",{get:function(){return this.decorator?this.decorator.handler:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"check",{get:function(){if(this.decorator){if(this.shouldCheck)switch(this.decorator.type){case"property":case"event":return this;default:return this.decorator;}}},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"validate",{get:function(){if(this.decorator){if(this.shouldCheck)switch(this.decorator.type){case"property":return this;default:return this.decorator;}}},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"checker",{get:function(){return this.decorator?this.decorator.checkerAll:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"validator",{get:function(){return this.decorator?this.decorator.validatorAll:void 0},enumerable:!0,configurable:!0}),o}(),memberDecorator=function(){function o(){var s=this;this.isPrototype=!0,this.befores=[],this.afters=[],this.checks=[],this.onGets=[],this.validates=[],this.bindBefores=[],this.bindAfters=[],this.beforeBindChanges=[],this.afterBindChanges=[],this.listenPaths=[],this.childrenListenPaths=[],this.defaultValue=function(l){return s.defaultPropertyValue=l,s},this.listeners={},this.addListen=function(l){var g=obp.analyzePath(l),u=g.join(""),m=new listener(g,s);s.listeners[u]&&(s.listeners[u].clear(),s.listeners[u].parent=void 0),s.listeners[u]=m,m.listen()},this.removeListen=function(l){var g=obp.analyzePath(l),u=g.join("");s.listeners[u]&&(s.listeners[u].clear(),s.listeners[u].parent=void 0,s.listeners[u]=void 0)},this.initializeListen=function(){s.listenPaths.forEach(function(l){var g=l.join(""),u=new listener(l,s);s.listeners[g]=u,u.listen()})},this.before=function(l){return s.befores.push({target:"self",path:obp.analyzePath(l)}),s},this.after=function(l){return s.afters.push({target:"self",path:obp.analyzePath(l)}),s},this.beforeBindChange=function(l){return s.beforeBindChanges.push({target:"self",path:obp.analyzePath(l)}),s},this.afterBindChange=function(l){return s.afterBindChanges.push({target:"self",path:obp.analyzePath(l)}),s},this.check=function(l){return s.checks.push({target:"self",path:obp.analyzePath(l)}),s},this.onGet=function(l){return s.onGets.push({target:"self",path:obp.analyzePath(l)}),s},this.validate=function(l){return s.validates.push({target:"self",validator:l}),s},this.bind=function(l,g){return s.bindingPath=obp.analyzePath(l),s.bindingPathMode=g?g:PathBindingMode.bind,s},this.syncFrom=function(l){return s.bindingPath=obp.analyzePath(l),s.bindingPathMode=PathBindingMode.syncFrom,s},this.updateTo=function(l){return s.bindingPath=obp.analyzePath(l),s.bindingPathMode=PathBindingMode.updateTo,s},this.setBindingPath=function(l,g){var u=[s.target,s.propertyKey+":BeforeBindPathChange",[],l,s.bindingPath];if(s.beforeBindChanges.forEach(function(O){return O&&!obs.isDisposed(O.target)&&(obp.invokeTrigger(O,u),!0)}),s.bindingPathChangedTrigger&&(s.bindingPathChangedTrigger.target=void 0),s.bindingPath=obp.analyzePath(l),s.bindingPathMode=g,s.bindingPath&&0<s.bindingPath.length){s.bindingPathChangedTrigger={target:s,method:s.bindingPathChanged},s.bindingPath&&obp.setPathChangedTrigger(s.target,s.bindingPath,s.bindingPathChangedTrigger);var m=obp.getPathSourceKeyValue(s.target,s.bindingPath);obp.invokeTrigger(s.triggerOnly,[m.source,m.key,[],m.value,s.RealValue])}s.afterBindChanges.forEach(function(O){return O&&!obs.isDisposed(O.target)&&(obp.invokeTrigger(O,u),!0)})},this.bindingPathChanged=function(){if(s.bindingPathChangedTrigger&&(s.bindingPathChangedTrigger.target=void 0),s.bindingPathChangedTrigger={target:s,method:s.bindingPathChanged},s.bindingPath&&0!=s.bindingPath.length){obp.setPathChangedTrigger(s.target,s.bindingPath,s.bindingPathChangedTrigger);var m=obp.getPathSourceKeyValue(s.target,s.bindingPath);obp.invokeTrigger(s.triggerOnly,[m.source,m.key,[],m.value,s.RealValue])}},this.clearValuePaths=function(l){if(s.target&&obs.isInitialized(s.target)&&l&&(s.defaultPath&&obp.setPathValue(l,s.defaultPath,void 0,void 0,s.propertyKey),obs.isObservableArray(l))){if(s.childDefaultPath&&(l.childDefaultPath=void 0),s.childrenListenPaths&&0<s.childrenListenPaths.length&&(l.childrenListenPaths=[]),s.observePath){var g=obs.getDecorator(l,"observationSource",!0);g&&g.setBindingPath(void 0,PathBindingMode.syncFrom)}if(s.observerPath){var g=obs.getDecorator(l,"observer",!0);g&&g.setBindingPath(void 0,PathBindingMode.syncFrom)}if(s.populatePath){var u=obs.getDecorator(l,"populationTarget",!0);u&&u.setBindingPath(void 0,PathBindingMode.syncFrom)}if(s.populatorPath){var u=obs.getDecorator(l,"populator",!0);u&&u.setBindingPath(void 0,PathBindingMode.syncFrom)}}},this.setValuePaths=function(l){if(s.target&&obs.isInitialized(s.target)&&l&&(s.defaultPath&&obp.setPathValue(l,s.defaultPath,s.target,s.target,s.propertyKey),obs.isObservableArray(l))){if(s.childDefaultPath&&(l.childDefaultPath=s.childDefaultPath),s.childrenListenPaths&&0<s.childrenListenPaths.length&&(l.childrenListenPaths=s.childrenListenPaths),s.observePath){var g=obs.getDecorator(l,"observationSource",!0);g&&g.setBindingPath(s.observePath,PathBindingMode.syncFrom)}if(s.observerPath){var g=obs.getDecorator(l,"observer",!0);g&&g.setBindingPath(s.observerPath,PathBindingMode.syncFrom)}if(s.populatePath){var u=obs.getDecorator(l,"populationTarget",!0);u&&u.setBindingPath(s.populatePath,PathBindingMode.syncFrom)}if(s.populatorPath){var u=obs.getDecorator(l,"populator",!0);u&&u.setBindingPath(s.populatorPath,PathBindingMode.syncFrom)}}},this.replaceSelf=function(l,g){s.target=l,s.propertyKey=g,s.befores.forEach(function(u){"self"==u.target&&(u.target=l)}),s.afters.forEach(function(u){"self"==u.target&&(u.target=l)}),s.checks.forEach(function(u){"self"==u.target&&(u.target=l)}),s.validates.forEach(function(u){"self"==u.target&&(u.target=l)})},this.instantiate=function(){switch(s.type){case"property":s.property(s.target,s.propertyKey);break;case"event":s.event(s.target,s.propertyKey);break;case"method":s.method(s.target,s.propertyKey);break;case"readonly":s.readonly(s.target,s.propertyKey);}s.setValuePaths(s.RealValue),s.initializeBindingPath(),s.initializeListen(),s.blocking=!1,s.instantiated=!0},this.initialize=function(){s.isPrototype&&(s.target["@ObjectService.Prototype"]=!0)},this.readonly=function(l,g,u){obs.disabled||(s.replaceSelf(l,g),obs.setDecorator(l,g,s).initializeReadonly(l,g,u))},this.initializeReadonly=function(l,g,u){s.initialize(),s.type="readonly",u?(u.configurable=!0,u.enumerable=!1,s.getter=u.get):Object.defineProperty(l,g,{enumerable:!1,get:s.getter})},this.property=function(l,g,u){obs.disabled||(s.replaceSelf(l,g),obs.setDecorator(l,g,s).initializeProperty(l,g,u))},this.initializeProperty=function(l,g,u){var m=s;s.initialize(),s.type="property",s.validatorAll=function(V,A,E,w,T){return E.some(function(R){return R===m})?w:(E.push(m),m.validates.forEach(function(R){w=m.invokeValidate(R,[V,A,E,w,T])}),w)},s.checkerAll=function(V,A,E){for(var w=[],T=3;T<arguments.length;T++)w[T-3]=arguments[T];if(E.some(function(M){return M===m}))return!0;E.push(m);var R=[V,A,E];return obs.isArray(w)&&w.forEach(function(M){return R.push(M)}),m.checks.every(function(M){return m.invokeCheck(M,R)})},s.bindSetter=function(V,A,E,w,T,R,M){if(s.blocking)m.RealValue=w;else{if(obs.isArray(E)||(E=[]),E.some(function(W){return W===m}))return!0;if(E.push(m),!m.checkerAll.apply(void 0,[V,A,[],w,m.RealValue]))return!1;w=m.validatorAll.apply(l,[V,A,[],w,m.RealValue]),void 0===V&&(V=l),void 0===A&&(A=g),void 0===T&&(T=m.RealValue);var F=[],L=[];if(!m.bindBefores.every(function(W){return W.check&&W.check.target&&!obs.isDisposed(W.check.target)&&!m.invokeCheck(W.check,[V,A,F,w,T])?!1:(W.validate&&(w=m.invokeValidate(W.validate,[V,A,L,w,T])),!0)}))return!1;var K=[V,A,E,w,T];obs.isArray(R)||(R=[]);var N=[V,A,R,w,T];if(m.befores=m.befores.filter(function(W){return W&&!obs.isDisposed(W.target)&&(obp.invokeTrigger(W,N),!0)}),m.bindBefores=m.bindBefores.filter(function(W){return W.target&&!obs.isDisposed(W.target)&&(obp.invokeTrigger(W,K),!0)}),m.RealValue=w,!M)switch(m.bindingPathMode){case PathBindingMode.bind:case PathBindingMode.updateTo:obp.setPathValue(l,m.bindingPath,w,l,g);}m.bindAfters=m.bindAfters.filter(function(W){return W.target&&!obs.isDisposed(W.target)&&(obp.invokeTrigger(W,K),!0)}),m.afters=m.afters.filter(function(W){return W&&!obs.isDisposed(W.target)&&(obp.invokeTrigger(W,N),!0)})}return!0},s.invoker=function(){for(var V=[],A=0;A<arguments.length;A++)V[A]=arguments[A];return m.blocking?void 0:obs.isFunction(m.RealValue)?m.RealValue.apply(l,V):void 0};var O=function(A){switch(obs.statusStack[0]){case invokeStatus.bindBefore:A&&m.bindBefores.push(A),A.decorator&&A.decorator.bindBefores.push(m.bindOnly);break;case invokeStatus.bindBeforeWithCheckValidate:A&&m.bindBefores.push(A),A.decorator&&A.decorator.bindBefores.push(m.bindCheckValidate);break;case invokeStatus.bindAfter:A&&m.bindAfters.push(A),A.decorator&&A.decorator.bindAfters.push(m.bindOnly);break;case invokeStatus.updateOneWayToBeforeWithCheckValidate:case invokeStatus.updateOneWayToBefore:A&&m.bindBefores.push(A);break;case invokeStatus.updateOneWayToAfter:A&&m.bindAfters.push(A);break;case invokeStatus.check:A&&m.checks.push(A);case invokeStatus.validate:A&&m.validates.push(A);case invokeStatus.none:default:m.bindSetter.apply(l,[void 0,void 0,[],A,m.RealValue]);}},S={target:l,validator:s.validatorAll};s.bindOnly={target:l,method:s.bindSetter,decorator:m},s.bindCheckValidate={target:l,method:s.bindSetter,validate:S,decorator:m},s.checker=function(V,A,E){for(var w=[],T=3;T<arguments.length;T++)w[T-3]=arguments[T];if(E.some(function(M){return M===m}))return!0;if(E.push(m),obs.isFunction(m.RealValue)){var R=[V,A,E];return obs.isArray(w)&&w.forEach(function(M){return R.push(M)}),m.RealValue.apply(l,R)}return!0},s.validator=function(V,A,E,w,T){return E.some(function(R){return R===m})?w:(E.push(m),obs.isFunction(m.RealValue)&&(w=m.RealValue.apply(l,[V,A,E,w,T])),w)},s.handler=function(V,A,E){if(!E.some(function(R){return R===m}))switch(E.push(m),s.bindingPathMode){case PathBindingMode.bind:case PathBindingMode.syncFrom:var T=obp.getPathValue(m.target,m.bindingPath);m.bindSetter.apply(m.target,[V,A,[],T,m.RealValue,E,!0]);break;case PathBindingMode.updateTo:obp.setPathValue(m.target,m.bindingPath,m.realValue,m.target,m.propertyKey);}};var D=function(){switch(obs.statusStack[0]){case invokeStatus.invokeBefore:case invokeStatus.invokeAfter:case invokeStatus.invokeBeforeWithCheck:return m.triggerOnly;case invokeStatus.bindBefore:case invokeStatus.bindAfter:case invokeStatus.updateOneWayToBefore:case invokeStatus.updateOneWayToAfter:return m.bindOnly;case invokeStatus.updateOneWayToBeforeWithCheckValidate:case invokeStatus.bindBeforeWithCheckValidate:return m.bindCheckValidate;case invokeStatus.check:case invokeStatus.validate:case invokeStatus.decorator:return m;case invokeStatus.none:default:return m.onGets=m.onGets.filter(function(A){return A&&!obs.isDisposed(A.target)&&(obp.invokeTrigger(A,[l,g,[]]),!0)}),m.RealValue;}};if(void 0!==s.defaultPropertyValue&&(s.RealValue=s.defaultPropertyValue),u?(u.configurable=!0,m.bindSetter.apply(l,[void 0,void 0,[],u.value,void 0]),delete u.value,delete u.writable,u.get=D,u.set=O):Object.defineProperty(l,g,{get:D,set:O}),s.observableType){var C=obs.makeObservable(new(Function.prototype.bind.apply(s.observableType,[])));if(obs.isArray(s.realValue)){var B;util.appendArray(C,B)}m.bindSetter.apply(l,[void 0,void 0,[],C,void 0])}},this.blocking=!1,this.suspend=function(){s.blocking=!0},this.resume=function(){s.blocking=!1},this.event=function(l,g,u){obs.disabled||(s.replaceSelf(l,g),obs.setDecorator(l,g,s).initializeEvent(l,g,u))},this.initializeEvent=function(l,g,u){var m=s;s.initialize(),s.type="event",m.checkerAll=function(C,B,V){for(var A=[],E=3;E<arguments.length;E++)A[E-3]=arguments[E];if(V.some(function(T){return T===m}))return!0;V.push(m);var w=[C,B,V];return obs.isArray(A)&&A.forEach(function(T){return w.push(T)}),m.checks.every(function(T){return m.invokeCheck(T,w)})};var O=function(B,V,A){for(var E=[],w=3;w<arguments.length;w++)E[w-3]=arguments[w];if(obs.isArray(A)||(A=[]),!A.some(function(F){return F===m})){A.push(m);var T=[B,V,[]];if((obs.isArray(E)&&E.forEach(function(F){return T.push(F)}),!!m.checkerAll.apply(void 0,T))&&(void 0===T[0]&&(T[0]=l),void 0===T[1]&&(T[1]=g),!!m.befores.every(function(F){return F.check&&F.check.target&&!obs.isDisposed(F.check.target)?m.invokeCheck(F.check,T):!0}))){var R=[B,V,A];obs.isArray(E)&&E.forEach(function(F){return R.push(F)}),m.befores=m.befores.filter(function(F){return F&&!obs.isDisposed(F.target)&&(obp.invokeTrigger(F,R),!0)});var M;return obs.isFunction(m.RealValue)&&(M=m.RealValue.apply(l,E)),m.afters=m.afters.filter(function(F){return F&&!obs.isDisposed(F.target)&&(obp.invokeTrigger(F,R),!0)}),M}}};s.invoker=function(){for(var C=[],B=0;B<arguments.length;B++)C[B]=arguments[B];if(obp.isEventProxy(s.target)&&console.log("EventProxy is invoked!!!"),!m.blocking){var V=[void 0,void 0,[]];return Array.prototype.push.apply(V,C),O.apply(void 0,V)}},s.checker=function(C,B,V){for(var A=[],E=3;E<arguments.length;E++)A[E-3]=arguments[E];if(V.some(function(T){return T===m}))return!0;if(V.push(m),obs.isFunction(m.RealValue)){var w=[C,B,V];return obs.isArray(A)&&A.forEach(function(T){return w.push(T)}),m.RealValue.apply(l,w)}return!0},s.validator=function(C,B,V,A,E){return V.some(function(w){return w===m})?A:(V.push(m),obs.isFunction(m.RealValue)&&(A=m.RealValue.apply(l,[C,B,V,A,E])),A)},s.handler=O;var S=function(){switch(obs.statusStack[0]){case invokeStatus.invokeBefore:case invokeStatus.invokeAfter:return m.triggerOnly;case invokeStatus.invokeBeforeWithCheck:return m.triggerCheck;case invokeStatus.check:case invokeStatus.validate:case invokeStatus.decorator:return m;case invokeStatus.none:default:return m.onGets=m.onGets.filter(function(B){return B&&!obs.isDisposed(B.target)&&(B.method.apply(B.target,[l,g]),!0)}),m.invoker;}};s.bindSetter=function(C,B,V,A,E){if(obs.isArray(V)||(V=[]),V.some(function(R){return R===m}))return!0;if(V.push(m),!m.checkerAll.apply(void 0,[C,B,[],A,E]))return!1;if(void 0===C&&(C=l),void 0===B&&(B=g),void 0===E&&(E=m.RealValue),!m.bindBefores.every(function(R){return R.check&&R.check.target&&!obs.isDisposed(R.check.target)&&!R.check.checker.apply(R.check.target,[C,B,[],A,E])?!1:(R.validate&&(A=R.validate.validator.apply(R.validate.target,[A,E])),!0)}))return!1;var T=[C,B,V,A,E];return m.bindBefores=m.bindBefores.filter(function(R){return R.target&&!obs.isDisposed(R.target)&&(R.method.apply(R.target,T),!0)}),m.RealValue=A,m.bindAfters=m.bindAfters.filter(function(R){return R.target&&!obs.isDisposed(R.target)&&(R.method.apply(R.target,T),!0)}),!0};var D=function(B){switch(obs.statusStack[0]){case invokeStatus.invokeBefore:B&&m.befores.push(B);break;case invokeStatus.invokeAfter:B&&m.afters.push(B);break;case invokeStatus.check:B&&m.checks.push(B);case invokeStatus.validate:B&&m.validates.push(B);case invokeStatus.none:default:m.bindSetter.apply(void 0,[void 0,void 0,[],B,m.RealValue]);}};void 0!==s.defaultPropertyValue&&(s.RealValue=s.defaultPropertyValue),u?(u.configurable=!0,m.bindSetter.apply(void 0,[void 0,void 0,[],u.value,void 0]),delete u.value,delete u.writable,u.get=S,u.set=D):Object.defineProperty(l,g,{get:S,set:D})},this.method=function(l,g,u){obs.disabled||(s.replaceSelf(l,g),obs.setDecorator(l,g,s).initializeMethod(l,g,u))},this.initializeMethod=function(l,g,u){var m=s;s.initialize(),s.type="method",s.checker=function(D,C,B){for(var V=[],A=3;A<arguments.length;A++)V[A-3]=arguments[A];if(B.some(function(w){return w===m}))return!0;if(B.push(m),obs.isFunction(m.RealValue)){var E=[D,C,B];return obs.isArray(V)&&V.forEach(function(w){return E.push(w)}),m.RealValue.apply(l,E)}return!0},s.validator=function(D,C,B,V,A){return B.some(function(E){return E===m})?V:(B.push(m),obs.isFunction(m.RealValue)&&(V=m.RealValue.apply(l,[D,C,B,V,A])),V)},s.handler=function(D,C,B,V){if(!B.some(function(A){return A===m}))return B.push(m),obs.isFunction(m.RealValue)?m.RealValue.apply(l,V):void 0},s.invoker=function(){for(var D=[],C=0;C<arguments.length;C++)D[C]=arguments[C];return m.blocking?void 0:obs.isFunction(m.RealValue)?m.RealValue.apply(l,D):void 0};var O=function(){switch(obs.statusStack[0]){case invokeStatus.invokeBefore:case invokeStatus.invokeAfter:case invokeStatus.bindBeforeWithCheckValidate:return m.triggerOnly;case invokeStatus.check:case invokeStatus.validate:case invokeStatus.decorator:return m;case invokeStatus.none:default:return m.invoker;}};s.bindSetter=function(D,C,B,V){return m.RealValue=V,!0};var S=function(C){m.RealValue=C};void 0!==s.defaultPropertyValue&&(s.RealValue=s.defaultPropertyValue),u?(u.configurable=!0,s.RealValue=u.value,delete u.value,delete u.writable,u.get=O,u.set=S):Object.defineProperty(l,g,{get:O,set:S})},this.allocate=function(l){var g=s.target;s.target=l.target,s.propertyKey=l.propertyKey;var u=s.target;s.befores.forEach(function(m){(m.target===g||"self"==m.target)&&(m.target=u)}),s.afters.forEach(function(m){(m.target===g||"self"==m.target)&&(m.target=u)}),s.bindBefores.forEach(function(m){(m.target===g||"self"==m.target)&&(m.target=u)}),s.bindAfters.forEach(function(m){(m.target===g||"self"==m.target)&&(m.target=u)}),s.beforeBindChanges.forEach(function(m){(m.target===g||"self"==m.target)&&(m.target=u)}),s.afterBindChanges.forEach(function(m){(m.target===g||"self"==m.target)&&(m.target=u)}),s.onGets.forEach(function(m){(m.target===g||"self"==m.target)&&(m.target=u)}),s.checks.forEach(function(m){(m.target===g||"self"==m.target)&&(m.target=u)}),s.validates.forEach(function(m){(m.target===g||"self"==m.target)&&(m.target=u)}),l.befores.forEach(function(m){return s.befores.push(m)}),l.afters.forEach(function(m){return s.afters.push(m)}),l.bindBefores.forEach(function(m){return s.bindBefores.push(m)}),l.bindAfters.forEach(function(m){return s.bindAfters.push(m)}),l.beforeBindChanges.forEach(function(m){return s.beforeBindChanges.push(m)}),l.afterBindChanges.forEach(function(m){return s.afterBindChanges.push(m)}),l.onGets.forEach(function(m){return s.onGets.push(m)}),l.checks.forEach(function(m){return s.checks.push(m)}),l.validates.forEach(function(m){return s.validates.push(m)}),l.listenPaths.forEach(function(m){return s.listenPaths.push(m)}),l.childrenListenPaths.forEach(function(m){return s.childrenListenPaths.push(m)}),l.observePath&&0<l.observePath.length&&(s.observePath=l.observePath),l.observerPath&&0<l.observerPath.length&&(s.observerPath=l.observerPath),l.populatePath&&0<l.populatePath.length&&(s.populatePath=l.populatePath),l.populatorPath&&0<l.populatorPath.length&&(s.populatorPath=l.populatorPath),l.observableType&&(s.observableType=l.observableType),void 0!==l.defaultPropertyValue&&(s.defaultPropertyValue=l.defaultPropertyValue)},this.setDefault=function(l){s.default(l);var g=s.RealValue;s.defaultPath&&0<s.defaultPath.length&&(console.log("setting default path ",s.defaultPath.join(""),g,s.target),obp.setPathValue(g,s.defaultPath,s.target,s.target,s.propertyKey))},this.setChildDefault=function(l){s.childDefault(l);var g=s.RealValue;!obs.isObservableArray(g)||s.childDefaultPath&&(g.childDefaultPath=void 0)},this.setObserve=function(l,g,u){s.observe(l,g,u);var m=s.RealValue;if(obs.isObservableArray(m)){if(s.observePath){console.log("----- Set observePath for RealValue -----",m);var O=obs.getDecorator(m,"observationSource",!0);O&&O.setBindingPath(s.observePath,PathBindingMode.syncFrom)}if(s.observerPath){var O=obs.getDecorator(m,"observer",!0);O&&O.setBindingPath(s.observerPath,PathBindingMode.syncFrom)}}},this.setPopulate=function(l,g,u){s.observe(l,g,u);var m=s.RealValue;if(obs.isObservableArray(m)){if(s.observePath){var O=obs.getDecorator(m,"observationSource",!0);O&&O.setBindingPath(s.observePath,PathBindingMode.syncFrom)}if(s.observerPath){var O=obs.getDecorator(m,"observer",!0);O&&O.setBindingPath(s.observerPath,PathBindingMode.syncFrom)}}},this.triggerCheck=new Trigger(this,!0),this.triggerOnly=new Trigger(this),this.type="method"}return o.prototype.observable=function(s){return this.observableType=s,this},o.prototype.clone=function(s){var l=this,g=new o;return g.target=s,g.propertyKey=this.propertyKey,g.isPrototype=!1,g.type=this.type,g.observableType=this.observableType,g.defaultPropertyValue=this.defaultPropertyValue,this.befores.forEach(function(u){g.befores.push({target:u.target===l.target?s:u.target,path:u.path,method:u.method,check:u.check,validate:u.validate})}),this.afters.forEach(function(u){g.afters.push({target:u.target===l.target?s:u.target,path:u.path,method:u.method,check:u.check,validate:u.validate})}),this.checks.forEach(function(u){g.checks.push({target:u.target===l.target?s:u.target,checker:u.checker,path:u.path})}),this.onGets.forEach(function(u){g.onGets.push({target:u.target===l.target?s:u.target,path:u.path,method:u.method,check:u.check,validate:u.validate})}),this.validates.forEach(function(u){g.validates.push({target:u.target===l.target?s:u.target,path:u.path,validator:u.validator})}),this.bindBefores.forEach(function(u){g.bindBefores.push({target:u.target===l.target?s:u.target,path:u.path,method:u.method,check:u.check,validate:u.validate})}),this.bindAfters.forEach(function(u){g.bindAfters.push({target:u.target===l.target?s:u.target,path:u.path,method:u.method,check:u.check,validate:u.validate})}),this.beforeBindChanges.forEach(function(u){g.beforeBindChanges.push({target:u.target===l.target?s:u.target,path:u.path,method:u.method,check:u.check,validate:u.validate})}),this.afterBindChanges.forEach(function(u){g.afterBindChanges.push({target:u.target===l.target?s:u.target,path:u.path,method:u.method,check:u.check,validate:u.validate})}),g.bindingPath=this.bindingPath,g.bindingPathMode=this.bindingPathMode,g.wrapPath=this.wrapPath,g.wrapConverterFrom=this.wrapConverterFrom,g.wrapConverterTo=this.wrapConverterTo,this.listenPaths.forEach(function(u){return g.listenPaths.push(u)}),g.childDefaultPath=this.childDefaultPath,this.childrenListenPaths.forEach(function(u){return g.childrenListenPaths.push(u)}),g.observePath=this.observePath,g.populatePath=this.populatePath,g.observerPath=this.observerPath,g.populatorPath=this.populatorPath,g.defaultPath=this.defaultPath,g.realValue=this.realValue,g.getter=this.getter,g},o.prototype.overwrite=function(s){var l=this;return console.trace("%%% overwrite from => to",s.realValue,"=>",this.realValue),this.befores.forEach(function(g){s.befores.push({target:g.target===l.target?s.target:g.target,path:g.path,method:g.method,check:g.check,validate:g.validate})}),this.afters.forEach(function(g){s.afters.push({target:g.target===l.target?s.target:g.target,path:g.path,method:g.method,check:g.check,validate:g.validate})}),this.checks.forEach(function(g){s.checks.push({target:g.target===l.target?s.target:g.target,checker:g.checker,path:g.path})}),this.onGets.forEach(function(g){s.onGets.push({target:g.target===l.target?s.target:g.target,path:g.path,method:g.method,check:g.check,validate:g.validate})}),this.validates.forEach(function(g){s.validates.push({target:g.target===l.target?s.target:g.target,path:g.path,validator:g.validator})}),this.bindBefores.forEach(function(g){s.bindBefores.push({target:g.target===l.target?s.target:g.target,path:g.path,method:g.method,check:g.check,validate:g.validate})}),this.bindAfters.forEach(function(g){s.bindAfters.push({target:g.target===l.target?s.target:g.target,path:g.path,method:g.method,check:g.check,validate:g.validate})}),this.beforeBindChanges.forEach(function(g){s.beforeBindChanges.push({target:g.target===l.target?s.target:g.target,path:g.path,method:g.method,check:g.check,validate:g.validate})}),this.afterBindChanges.forEach(function(g){s.afterBindChanges.push({target:g.target===l.target?s.target:g.target,path:g.path,method:g.method,check:g.check,validate:g.validate})}),this.bindingPath&&0<this.bindingPath.length&&(s.bindingPath=this.bindingPath),this.bindingPathMode&&(s.bindingPathMode=this.bindingPathMode),this.wrapPath&&0<this.wrapPath.length&&(s.wrapPath=this.wrapPath),this.wrapConverterFrom&&(s.wrapConverterFrom=this.wrapConverterFrom),this.wrapConverterTo&&(s.wrapConverterTo=this.wrapConverterTo),this.listenPaths.forEach(function(g){return s.listenPaths.push(g)}),this.childDefaultPath&&0<this.childDefaultPath.length&&(s.childDefaultPath=this.childDefaultPath),this.childrenListenPaths.forEach(function(g){return s.childrenListenPaths.push(g)}),this.observePath&&0<this.observePath.length&&(s.observePath=this.observePath),this.populatePath&&0<this.populatePath.length&&(s.populatePath=this.populatePath),this.observerPath&&0<this.observerPath.length&&(s.observerPath=this.observerPath),this.populatorPath&&0<this.populatorPath.length&&(s.populatorPath=this.populatorPath),this.defaultPath&&0<this.defaultPath.length&&(s.defaultPath=this.defaultPath),void 0!==this.realValue&&(s.realValue=this.realValue),void 0!=this.getter&&(s.getter=this.getter),this.observableType&&(s.observableType=this.observableType),void 0!==this.defaultPropertyValue&&(s.defaultPropertyValue=this.defaultPropertyValue),s.type=this.type,s},o.prototype.listen=function(){for(var s=[],l=0;l<arguments.length;l++)s[l]=arguments[l];return Array.prototype.push.apply(this.listenPaths,s.map(function(g){return obp.analyzePath(g)})),this},o.prototype.observe=function(s,l,g){var u=obp.analyzeMember(g);return u=u?"."+u:".parent",this.observePath=obp.analyzePath(s),this.observePath&&this.observePath.unshift(u),this.observerPath=obp.analyzePath(l),this.observerPath&&this.observerPath.unshift(u),this},o.prototype.populate=function(s,l,g){var u=obp.analyzeMember(g);return u=u?"."+u:".parent",this.populatePath=obp.analyzePath(s),this.populatePath&&this.populatePath.unshift(u),this.populatorPath=obp.analyzePath(l),this.populatorPath&&this.populatorPath.unshift(u),this},o.prototype.initializeBindingPath=function(){if(this.bindingPath&&0<this.bindingPath.length){var s=[this.target,this.propertyKey+":BeforeBindPathChange",[],this.bindingPath,void 0];this.bindingPathChangedTrigger={target:this,method:this.bindingPathChanged},obp.setPathChangedTrigger(this.target,this.bindingPath,this.bindingPathChangedTrigger);var l=obp.getPathSourceKeyValue(this.target,this.bindingPath);obp.invokeTrigger(this.triggerOnly,[l.source,l.key,[],l.value,this.RealValue]),this.afterBindChanges.forEach(function(g){return g&&!obs.isDisposed(g.target)&&(obp.invokeTrigger(g,s),!0)})}},o.prototype.default=function(s){return this.defaultPath=obp.analyzePath(s),this},o.prototype.childDefault=function(s){return this.childDefaultPath=obp.analyzePath(s),this},o.prototype.listenChildren=function(){for(var s=[],l=0;l<arguments.length;l++)s[l]=arguments[l];return Array.prototype.push.apply(this.childrenListenPaths,s.map(function(g){return obp.analyzePath(g)})),this},o.prototype.wrap=function(s,l,g){return this.wrapPath=obp.analyzePath(s),this.wrapConverterFrom=l,this.wrapConverterTo=g,this},Object.defineProperty(o.prototype,"RealValue",{get:function(){if(this.wrapPath){var l=obp.getPathValue(this.target,this.wrapPath);return this.wrapConverterFrom&&(l=this.wrapConverterFrom(l)),l}return this.realValue},set:function(l){if("value"==this.propertyKey&&(console.trace("~~~ set value: ",l),decoratorlist.push(this)),this.wrapPath){this.wrapConverterTo&&(l=this.wrapConverterTo(l));var g=obp.getPathValue(this.target,this.wrapPath);this.clearValuePaths(g),obp.setPathValue(this.target,this.wrapPath,l,this.target,this.propertyKey),this.setValuePaths(l)}else this.clearValuePaths(this.realValue),this.realValue=l,this.setValuePaths(this.realValue)},enumerable:!0,configurable:!0}),o.prototype.invokeCheck=function(s,l){return s.checker?s.checker.apply(s.target,l):s.path&&obs.isArray(s.path)?obp.invokePath(s.target,s.path,l):!0},o.prototype.invokeValidate=function(s,l){return s.validator?s.validator.apply(s.target,l):s.path&&obs.isArray(s.path)?obp.invokePath(s.target,s.path,l):l[2]},o.prototype.applyDecorator=function(s){var l=this;this.propertyKey||(this.propertyKey=s.propertyKey),this.target||(this.target=s.target);var g=this.target;if(s.befores.forEach(function(S){l.befores.push({target:S.target===s.target||"self"==S.target?g:S.target,method:S.method,path:S.path,check:S.check,decorator:S.decorator,validate:S.validate})}),s.afters.forEach(function(S){l.afters.push({target:S.target===s.target||"self"==S.target?g:S.target,method:S.method,path:S.path,check:S.check,decorator:S.decorator,validate:S.validate})}),s.bindBefores.forEach(function(S){l.bindBefores.push({target:S.target===s.target||"self"==S.target?g:S.target,method:S.method,path:S.path,check:S.check,decorator:S.decorator,validate:S.validate})}),s.bindAfters.forEach(function(S){l.bindAfters.push({target:S.target===s.target||"self"==S.target?g:S.target,method:S.method,path:S.path,check:S.check,decorator:S.decorator,validate:S.validate})}),this.beforeBindChanges.forEach(function(S){l.beforeBindChanges.push({target:S.target===s.target||"self"==S.target?g:S.target,method:S.method,path:S.path,check:S.check,decorator:S.decorator,validate:S.validate})}),this.afterBindChanges.forEach(function(S){l.afterBindChanges.push({target:S.target===s.target||"self"==S.target?g:S.target,method:S.method,path:S.path,check:S.check,decorator:S.decorator,validate:S.validate})}),this.onGets.forEach(function(S){l.onGets.push({target:S.target===s.target||"self"==S.target?g:S.target,method:S.method,path:S.path,check:S.check,decorator:S.decorator,validate:S.validate})}),this.checks.forEach(function(S){l.checks.push({target:S.target===s.target||"self"==S.target?g:S.target,checker:S.checker,path:S.path})}),this.validates.forEach(function(S){l.validates.push({target:S.target===s.target||"self"==S.target?g:S.target,path:S.path,validator:S.validator})}),s.listenPaths.forEach(function(S){return l.listenPaths.push(S)}),s.childDefaultPath&&(this.childDefaultPath=s.childDefaultPath),s.childrenListenPaths.forEach(function(S){return l.childrenListenPaths.push(S)}),s.observableType&&(this.observableType=s.observableType),s.observePath&&0<s.observePath.length&&(this.observePath=s.observePath),s.observerPath&&0<s.observerPath.length&&(this.observerPath=s.observerPath),s.populatePath&&0<s.populatePath.length&&(this.populatePath=s.populatePath),s.populatorPath&&0<s.populatorPath.length&&(this.populatorPath=s.populatorPath),void 0!==s.defaultPropertyValue&&(this.defaultPropertyValue=s.defaultPropertyValue),!this.instantiated)s.bindingPath&&0<s.bindingPath.length&&(this.bindingPath=s.bindingPath),s.bindingPathMode&&(this.bindingPathMode=s.bindingPathMode);else if(s.bindingPath&&0<s.bindingPath.length&&this.setBindingPath(s.bindingPath,s.bindingPathMode),s.listenPaths.forEach(function(S){return l.addListen(S)}),obs.isObservableArray(this.RealValue)){var u=this.RealValue;if(s.childDefaultPath&&(u.childDefaultPath=this.childDefaultPath),s.childrenListenPaths.forEach(function(S){return u.listenChildren(S)}),this.observePath){var m=obs.getDecorator(u,"observationSource",!0);m&&m.setBindingPath(this.observePath,PathBindingMode.syncFrom)}if(this.observerPath){var m=obs.getDecorator(u,"observer",!0);m&&m.setBindingPath(this.observerPath,PathBindingMode.syncFrom)}if(this.populatePath){var O=obs.getDecorator(u,"populationTarget",!0);O&&O.setBindingPath(this.populatePath,PathBindingMode.syncFrom)}if(this.populatorPath){var O=obs.getDecorator(u,"populator",!0);O&&O.setBindingPath(this.populatorPath,PathBindingMode.syncFrom)}}},o}();exports.memberDecorator=memberDecorator;var listener=function(){return function(s,l){var g=this;this.path=s,this.parent=l,this.listen=function(){if(g.path&&0<g.path.length){var u=obp.getPathSourceKeyValue(g.parent.target,g.path);if(u&&u.source&&u.key){var m=obs.getDecorator(u.source,u.key,!0);m&&"event"==m.type?(g.trigger={target:g.parent.target,method:g.parent.handler},m.afters.push(g.trigger)):(g.target=u.source,g.property=u.key,g.target[g.property]=g.parent.invoker)}g.path&&0<g.path.length&&(g.pathChanged={target:g,method:g.onPathChanged}),obp.setPathChangedTrigger(g.parent.target,g.path,g.pathChanged)}},this.clear=function(){g.pathChanged&&(g.pathChanged.target=void 0,g.pathChanged.method=void 0,g.pathChanged=void 0),g.target&&g.property&&(g.target[g.property]=void 0),g.target=void 0,g.property=void 0,g.trigger&&(g.trigger.target=void 0,g.trigger.method=void 0,g.trigger=void 0)},this.onPathChanged=function(){g.clear(),g.listen()}}}();exports.listener=listener;var objectDecorator=function(){function objectDecorator(){var _this=this;this.in=function(o){return _this.modulePath=o,_this},this.bindableBase=function(target,instanceFunction){var that,original=target,obd=_this,invoker=eval("(function (original, construct, setThat) {\n    var "+original.name+" = function () {\n        setThat(this);\n        var instance = this;\n        if (instance[\"@ObjectService.ConstructionStack\"]) {\n            instance[\"@ObjectService.ConstructionStack\"].push(original.name);\n        }\n        else {\n            Object.defineProperty(instance, \"@ObjectService.ConstructionStack\", {\n                configurable: false, \n                enumerable: false, \n                value: [original.name]\n            });\n        }\n        var newValue = construct(arguments);\n        instance[\"@ObjectService.ConstructionStack\"].pop();\n        return newValue;\n    };\n    "+original.name+".prototype = original.prototype;\n    return "+original.name+";\n})");return invoker(original,function(args){var classPrototype=original.prototype,builder=eval("(function(cnstr, proto, that, args) {\n                let "+original.name+" = function () {\n                    return cnstr.apply(that, args);\n                };\n                "+original.name+".prototype = proto;\n                return "+original.name+"();\n            })")(original,classPrototype,that,args);if(1==that["@ObjectService.ConstructionStack"].length){var prototypeDecorators=classPrototype["@ObjectService.Decorators"],instanceDecorators=that["@ObjectService.Decorators"];for(var key in Object.defineProperty(that,"@ObjectService.Instance",{configurable:!1,enumerable:!1,value:!0,writable:!1}),Object.defineProperty(that,"@ObjectService.ModulePath",{configurable:!1,enumerable:!0,value:obd.modulePath,writable:!1}),Object.defineProperty(that,"@ObjectService.TypeName",{configurable:!1,enumerable:!0,value:original.name,writable:!1}),Object.defineProperty(that,"@ObjectService.Decorators",{configurable:!1,enumerable:!1,value:{},writable:!1}),obd.isReferenceType&&Object.defineProperty(that,"@ObjectService.Reference",{configurable:!1,enumerable:!0,value:!0,writable:!1}),instanceDecorators)that["@ObjectService.Decorators"][key]=instanceDecorators[key].clone(that),that["@ObjectService.Decorators"][key].instantiate()}return instanceFunction&&instanceFunction(that,classPrototype),builder},function(o){that=o})},this.proxy=function(o){var l={deleteProperty:function(u,m){return console.log("deleting "+m+" of ",u),delete u[m],!0},get:function(u,m){return u[m]},set:function(u,m,O){return console.log("setting",m,"for",u," to value: (",O,")"),u[m]=O,!0}};return _this.bindableBase(o,function(g){return Object.defineProperty(g,"@ObjectService.Proxy",{configurable:!1,enumerable:!0,value:!0,writable:!1}),new Proxy(g,l)})},this.bindable=function(o){return _this.bindableBase(o)},this.observable=function(o){var s={deleteProperty:function(u,m){return(delete u[m],!!u.inOverwrittenOperation)||(/^\d+$/ig.test(m.toString())&&u.onchange&&u.onchange({array:u,operation:ArrayOperationType.delete,startIndex:+m}),!0)},get:function(u,m){return u[m]},set:function(u,m,O){var D=u[m];if(u[m]=O,/^\d+$/ig.test(m)){if(u.itemListeners[m]=new itemListener(u,O,u.childrenListenPaths),u.childDefaultPath&&0<u.childDefaultPath.length&&(obp.setPathValue(D,this.childDefaultPath,void 0,this,"childDefaultPath"),obp.setPathValue(O,this.childDefaultPath,this,this,"childDefaultPath")),u.inOverwrittenOperation)return!0;u.onchange&&u.onchange({array:u,items:[O],operation:ArrayOperationType.replace,startIndex:+m})}return!0}};return _this.bindableBase(o,function(u){return Object.defineProperty(u,"@ObjectService.ObservableArray",{configurable:!1,enumerable:!0,value:!0,writable:!1}),new Proxy(u,s)})}}return Object.defineProperty(objectDecorator.prototype,"ref",{get:function(){return this.isReferenceType=!0,this},enumerable:!0,configurable:!0}),objectDecorator.setupBindable=function(o,s){var l=s["@ObjectService.Decorators"],g=o["@ObjectService.Decorators"];for(var u in Object.defineProperty(o,"@ObjectService.Instance",{configurable:!1,enumerable:!1,value:!0,writable:!1}),Object.defineProperty(o,"@ObjectService.Decorators",{configurable:!1,enumerable:!1,value:{},writable:!1}),g)o["@ObjectService.Decorators"][u]=g[u].clone(o),o["@ObjectService.Decorators"][u].instantiate()},objectDecorator}();exports.objectDecorator=objectDecorator;var obp=function(){function obp(){}return obp.invokeTrigger=function(o,s){return o.method?o.method.apply(o.target,s):obp.invokePath(o.target,o.path,s)},obp.isFunctionPath=function(o){return"string"==typeof o&&/^\s*(\.\s*[$\w]+|\[\s*'[@$#%&=~,:;/<>\\\?\!\*\(\)\+\^\-\.\w ]+'\s*\]|\[\s*"[@$#%&=~,:;/<>\\\?\!\*\(\)\+\^\-\.\w ]+"\s*\]|\[\s*\d+\s*\])(\s*\(\s*\))\s*$/ig.test(o)},obp.isBracketPath=function(o){return"string"==typeof o&&/^\s*(\[\s*'[@$#%&=~,:;/<>\\\?\!\*\(\)\+\^\-\.\w ]+'\s*\]|\[\s*"[@$#%&=~,:;/<>\\\?\!\*\(\)\+\^\-\.\w ]+"\s*\]|\[\s*\d+\s*\])\s*$/ig.test(o)},obp.isAccessorPath=function(o){return"string"==typeof o&&/^\s*(\.\s*[$\w]+)\s*$/ig.test(o)},obp.getFunctionAccessor=function(o){return"string"==typeof o?o.substr(0,/\s*\(\s*\)\s*$/ig.exec(o).index):""},obp.getPathType=function(o){return obp.isFunctionPath(o)?"function":obp.isBracketPath(o)?"bracket":obp.isPropertyPath(o)?"property":void 0},obp.invokeCommandByString=function(host,command){return eval("(function(host){try {return host"+command+";} catch(ex){return;}})")(host)},obp.invokeMethodByString=function(host,method,args){var func=eval("(function(host, args){try {return host"+method+";} catch(ex){console.log(\"inner error: \", ex); return;}})")(host,args);return func?func.apply(host,args):void 0},obp.getPropertyDescriptorByString=function(host,member){return eval("(function(host, args){try {return Object.getOwnPropertyDescriptor(host, \""+member+"\");} catch(ex){return null;}})")(host)},obp.analyzePath=function(o){if(!o)return[];var s,l=[];if(obs.isFunction(o)){s=o.toString();var u=/(return|\s*\(\s*\)\s*=>)\s+/ig.exec(s);s=s.substr(u.index+u[0].length)}else if(obs.isArray(o)){s=o.join("")}else s=o.toString();for(var S,O=/\s*(\.\s*[$\w]+|\[\s*'[@$#%&=~,:;/<>\\\?\!\*\(\)\+\^\-\.\w ]+'\s*\]|\[\s*"[@$#%&=~,:;/<>\\\?\!\*\(\)\+\^\-\.\w ]+"\s*\]|\[\s*\d+\s*\])(\s*\(\s*\)|)/ig;S=O.exec(s);)/\s*\.\s*prototype/ig.test(S[0])?l.splice(0,l.length):l.push(obp.trimPath(S[0]));return l},obp.trimPath=function(o){var s;return(s=/\s*(\.)\s*([$\w]+)(\s*(\()\s*(\))|)/ig.exec(o))?s[1]+s[2]+(s[4]?s[4]:"")+(s[5]?s[5]:""):(s=/\s*(\[)\s*('[@$#%&=~,:;/<>\\\?\!\*\(\)\+\^\-\.\w ]+')\s*(\])(\s*(\()\s*(\))|)/ig.exec(o))?s[1]+s[2]+s[3]+(s[5]?s[5]:"")+(s[6]?s[6]:""):(s=/\s*(\[)\s*("[@$#%&=~,:;/<>\\\?\!\*\(\)\+\^\-\.\w ]+")\s*(\])(\s*(\()\s*(\))|)/ig.exec(o))?s[1]+s[2]+s[3]+(s[5]?s[5]:"")+(s[6]?s[6]:""):(s=/\s*(\[)\s*(\d+)\s*(\])(\s*(\()\s*(\))|)/ig.exec(o))?s[1]+s[2]+s[3]+(s[5]?s[5]:"")+(s[6]?s[6]:""):""},obp.analyzeMember=function(o){var s;if(obs.isFunction(o)){var l=obp.analyzePath(o);l&&0<l.length&&(s=/[$\w]+/ig.exec(obp.analyzePath(o)[0])[0])}return"string"==typeof o&&(s=/[$\w]+/ig.exec(o)[0]),s},obp.getPropertyName=function(o){return /\s*(\.\s*([$\w]+)(\s*\(\s*\)|)|\[\s*'([@$#%&=~,:;/<>\\\?\!\*\(\)\+\^\-\.\w]+)'\s*\](\s*\(\s*\)|)|\[\s*"([@$#%&=~,:;/<>\\\?\!\*\(\)\+\^\-\.\w]+)"\s*\](\s*\(\s*\)|)|\[(\s*\d+\s*)\](\s*\(\s*\)|))/ig.exec(o)[2]},obp.isPropertyPath=function(o){return /^\s*\.\s*([$\w]+)\s*$/ig.test(o)},obp.getPathProperty=function(o){return /^\s*\.\s*([$\w]+)\s*$/ig.exec(o)[1]},obp.setAccessorValue=function(host,path,value){var func=eval("(function (host, value) { host"+path+" = value;})");func&&func(host,value)},obp.setPathValue=function(o,s,l,g,u){var m=this;if(o&&s&&obs.isArray(s)){for(var O=[o],S=function(B){var V=[];".$$invokeEachElementInArray()"==s[B].replace(/\s+/ig,"")?O.forEach(function(A){obs.isArray(A)&&A.forEach(function(E){return V.push(E)})}):O.forEach(function(A){var E;if(B==s.length-1)switch(obp.getPathType(s[B])){case"function":break;case"bracket":obp.setAccessorValue(A,s[B],l);break;case"property":var w=obp.getPathProperty(s[B]),T=obs.getDecorator(A,w,!0);T?T.bindSetter.apply(T.target,[g,u,[m],l,T.RealValue,[m]]):A[w]=l;}else E=obp.invokeCommandByString(A,s[B]),E&&V.push(E)}),O=V},D=0;D<s.length;D++)S(D);return!0}},obp.setPathChangedTrigger=function(o,s,l){for(var g=0;g<s.length&&!obp.isEventProxy(o);g++){if(obp.isPropertyPath(s[g])){var u=obs.getDecorator(o,obp.getPropertyName(s[g]));u&&"property"==u.type&&u.afters.push(l)}o=obp.invokeCommandByString(o,s[g])}},obp.isEventProxy=function(o){return!!o&&o["@ObjectService.EventProxy"]},obp.getEventProxyPath=function(o){var s=o.map(function(l){return obp.trimPath(l)}).join("");return /^\./.test(s)&&(s=s.substr(1)),s},obp.invokePath=function(o,s,l){if(s&&obs.isArray(s)){for(var S,g=[o],m=function(C){var B=[];if(g.forEach(function(V){if(obp.isEventProxy(V)){var A=obp.getEventProxyPath(s.slice(C)),E=obs.getDecorator(V,A);E.invoker.apply(V,l)}else if(".$$invokeEachElementInArray()"==s[C].replace(/\s+/ig,""))obs.isArray(V)&&V.forEach(function(T){return B.push(T)});else{var w;if(C!=s.length-1)w=obp.invokeCommandByString(V,s[C]);else if(w=obp.invokeCommandByString(V,s[C]),obs.isFunction(w))try{w.apply(V,l)}catch(T){console.trace("Error invokePath:",V,s[C],s.join(""),T)}w&&B.push(w)}}),g=B,0==g.length)return"break"},O=0;O<s.length&&(S=m(O),"break"!==S);O++);return g}},obp.getPathValue=function(o,s){if(o&&s&&obs.isArray(s)){for(var g=0;g<s.length;g++)if(g!=s.length-1)o=obp.invokeCommandByString(o,s[g]);else if(obp.isFunctionPath(s[g])){var u=obp.getFunctionAccessor(s[g]);o=obp.invokeMethodByString(o,u,[])}else o=obp.invokeCommandByString(o,s[g]);return o}},obp.getPathSourceKeyValue=function(o,s){if(o&&s&&obs.isArray(s)){for(var l,g,u,m=0;m<s.length;m++)if(obp.isEventProxy(o)){l=o,u=obp.getEventProxyPath(s.slice(m));obs.getDecorator(o,u);g=o[u];break}else m==s.length-1?(l=o,u=obp.getPropertyName(s[m]),g=obp.invokeCommandByString(o,s[m])):o=obp.invokeCommandByString(o,s[m]);return{source:l,key:u,value:g}}},obp}();exports.obp=obp;var debug=function(){function o(){}return o.logPropertyDecorators=function(s){for(var l in console.log("---- Begin list Decorators for; ",s),s["@ObjectService.Decorators"]){var g=s["@ObjectService.Decorators"][l];console.log("MemberDecorator for "+l,g)}console.log("---- End list Decorator")},o.logPropertyDecorator=function(s,l){var g=obp.analyzeMember(l),u=obs.getDecorator(s,g,!0);console.log("MemberDecorator for "+g,u)},o}();exports.debug=debug;var obs=function(){function o(){}return o.enableBindable=function(s,l){objectDecorator.setupBindable(s,l)},o.stringifyReplacer=function(s,l){if(l["@ObjectService.ModulePath"]&&l["@ObjectService.TypeName"]){var g={};for(var u in l)switch(u){case"@ObjectService.Prototype":case"@ObjectService.Decorators":break;case"@ObjectService.ModulePath":g["@Serializable.ModuleName"]=l[u];break;case"@ObjectService.TypeName":g["@Serializable.TypeName"]=l[u];break;default:var m=o.getDecorator(l,u,!0);m||(g[u]=l[u]);}var O=l["@ObjectService.Decorators"];for(var S in O){var m=O[S];"property"==m.type&&void 0===g[S]&&(g[S]=m.RealValue)}return g}return l},o.parseReviver=function(s,l){return l["@Serializable.ModuleName"]&&l["@Serializable.TypeName"]?(System.import(l["@Serializable.ModuleName"]).then(function(g){var u=g[l["@Serializable.TypeName"]],m=new(Function.prototype.bind.apply(u,[]));for(var O in l)switch(O){case"@Serializable.ModuleName":case"@Serializable.TypeName":break;default:m[O]=l[O];}console.log("replaced: ",m)}),l):l},o.defaultValue=function(s){return new memberDecorator().defaultValue(s)},o.childDefault=function(s){return new memberDecorator().childDefault(s)},o.new=function(s,l){return l(s),s},o.isInitialized=function(s){return s["@ObjectService.Instance"]},o.appendAfter=function(s,l,g){var u=obp.analyzeMember(l),m=o.getDecorator(s,u,!0);m&&m.afters.push(g)},o.appendMethodAfter=function(s,l,g,u){var m=obp.analyzeMember(l),O=o.getDecorator(s,m,!0),S={target:g,method:function(){for(var A=[],E=3;E<arguments.length;E++)A[E-3]=arguments[E];return u.apply(g,A)}};return O&&O.afters.push(S),S},o.appendBefore=function(s,l,g){var u=obp.analyzeMember(l),m=o.getDecorator(s,u,!0);m&&m.befores.push(g)},o.appendMethodBefore=function(s,l,g,u){var m=obp.analyzeMember(l),O=o.getDecorator(s,m,!0),S={target:g,method:function(){for(var A=[],E=3;E<arguments.length;E++)A[E-3]=arguments[E];return u.apply(g,A)}};return O&&O.befores.push(S),S},o.suspend=function(s,l){var g=obp.analyzeMember(l),u=o.getDecorator(s,g,!0);u&&u.suspend()},o.resume=function(s,l){var g=obp.analyzeMember(l),u=o.getDecorator(s,g,!0);u&&u.resume()},o.block=function(s,l,g,u){var m=obp.analyzeMember(l),O=o.getDecorator(s,m,!0);O&&O.suspend(),g.apply(u,[]),O&&O.resume()},o.in=function(s){return new objectDecorator().in(s)},Object.defineProperty(o,"ref",{get:function(){return new objectDecorator().ref},enumerable:!0,configurable:!0}),Object.defineProperty(o,"bindable",{get:function(){var l=new objectDecorator;return l.bindable},enumerable:!0,configurable:!0}),o.invokeBefore=function(s){o.statusStack.unshift(invokeStatus.invokeBefore),s.apply(void 0),o.statusStack.shift()},o.invokeAfter=function(s){o.statusStack.unshift(invokeStatus.invokeAfter),s.apply(void 0),o.statusStack.shift()},o.bindAfter=function(s){o.statusStack.unshift(invokeStatus.bindBefore),s.apply(void 0),o.statusStack.shift()},o.bindBefore=function(s){o.statusStack.unshift(invokeStatus.bindAfter),s.apply(void 0),o.statusStack.shift()},o.bindBeforeWithCheckValidate=function(s){o.statusStack.unshift(invokeStatus.bindBeforeWithCheckValidate),s.apply(void 0),o.statusStack.shift()},o.updateOneWayToBefore=function(s){o.statusStack.unshift(invokeStatus.updateOneWayToBefore),s.apply(void 0),o.statusStack.shift()},o.updateOneWayToAfter=function(s){o.statusStack.unshift(invokeStatus.updateOneWayToBefore),s.apply(void 0),o.statusStack.shift()},o.setBinding=function(s,l,g,u){o.getDecorator(s,l).setBindingPath(g,u)},o.isFunction=function(s){return s&&"function"==typeof s&&"[object Function]"===Object.prototype.toString.call(s)},o.isArray=function(s){return s&&"object"===("undefined"==typeof s?"undefined":_typeof(s))&&s[Symbol.iterator]},o.isObservableArray=function(s){return s&&"object"===("undefined"==typeof s?"undefined":_typeof(s))&&s[Symbol.iterator]&&s["@ObjectService.ObservableArray"]},o.getIterator=function(s){return s[Symbol.iterator]()},o.listen=function(){for(var s=[],l=0;l<arguments.length;l++)s[l]=arguments[l];return memberDecorator.prototype.listen.apply(new memberDecorator,s)},o.listenChildren=function(){for(var s=[],l=0;l<arguments.length;l++)s[l]=arguments[l];return memberDecorator.prototype.listenChildren.apply(new memberDecorator,s)},o.observe=function(s,l){return new memberDecorator().observe(s,l)},o.populate=function(s,l){return new memberDecorator().populate(s,l)},o.default=function(s){return new memberDecorator().default(s)},o.wrap=function(s,l,g){return new memberDecorator().wrap(s,l,g)},o.before=function(s){return new memberDecorator().before(s)},o.after=function(s){return new memberDecorator().after(s)},o.beforeBindChange=function(s){return new memberDecorator().beforeBindChange(s)},o.afterBindChange=function(s){return new memberDecorator().afterBindChange(s)},o.check=function(s){return new memberDecorator().check(s)},o.validate=function(s){return new memberDecorator().validate(s)},o.bind=function(s,l){return new memberDecorator().bind(s,l)},o.observable=function(s){return new memberDecorator().observable(s)},o.makeObservable=function(s){return new Proxy(s,{deleteProperty:function(u,m){return(delete u[m],!!u.inOverwrittenOperation)||(/^\d+$/ig.test(m.toString())&&u.onchange&&u.onchange({array:u,operation:ArrayOperationType.delete,startIndex:+m}),!0)},get:function(u,m){return u[m]},set:function(u,m,O){var D=u[m];if(u[m]=O,/^\d+$/ig.test(m)){if(u.itemListeners[m]=new itemListener(u,O,u.childrenListenPaths),u.childDefaultPath&&0<u.childDefaultPath.length&&(obp.setPathValue(D,this.childDefaultPath,void 0,this,"childDefaultPath"),obp.setPathValue(O,this.childDefaultPath,this,this,"childDefaultPath")),u.inOverwrittenOperation)return!0;u.onchange&&u.onchange({array:u,items:[O],operation:ArrayOperationType.replace,startIndex:+m})}return!0}})},Object.defineProperty(o,"readonly",{get:function(){return new memberDecorator().readonly},enumerable:!0,configurable:!0}),Object.defineProperty(o,"property",{get:function(){return new memberDecorator().property},enumerable:!0,configurable:!0}),Object.defineProperty(o,"event",{get:function(){return new memberDecorator().event},enumerable:!0,configurable:!0}),Object.defineProperty(o,"method",{get:function(){return new memberDecorator().method},enumerable:!0,configurable:!0}),o.isDisposed=function(s){return"object"==("undefined"==typeof s?"undefined":_typeof(s))&&s["@ObjectService.Disposed"]},o.dispose=function(s){"object"!=("undefined"==typeof s?"undefined":_typeof(s))||(s["@ObjectService.Disposed"]=!0)},o.getDecorator=function(s,l,g){if(s){s["@ObjectService.Decorators"]||(s["@ObjectService.Decorators"]={});var u=s["@ObjectService.Decorators"];if(s["@ObjectService.EventProxy"]){var m;return u[l]?m=u[l]:(m=new memberDecorator,u[l]=m,m.event(s,l)),m.target=s,m.propertyKey=l,m}if(!u[l]&&!g){var m=new memberDecorator;u[l]=m,m.target=s,m.propertyKey=l}return u[l]}},o.setDecorator=function(s,l,g){if(s&&"object"==("undefined"==typeof s?"undefined":_typeof(s))){s["@ObjectService.Decorators"]||(s["@ObjectService.Decorators"]={});var u=s["@ObjectService.Decorators"];return u[l]?u[l]!=g&&u[l].allocate(g):u[l]=g,u[l]}},o.applyDecorator=function(s,l,g){if(s&&"object"==("undefined"==typeof s?"undefined":_typeof(s))){var u=o.getDecorator(s,l);return u?(u.applyDecorator(g),u.instantiated?void 0:u):o.setDecorator(s,l,g)}},o.makeBindable=function(s,l,g){var u=[];for(var m in util.appendArray(u,l),l&&l.forEach(function(O){0>u.indexOf(O)&&u.push(O)}),g&&g.forEach(function(O){0>u.indexOf(O)&&u.push(O)}),s)0>u.indexOf(m)&&u.push(m);return g?u.forEach(function(O){-1<g.indexOf(O)?o.makeEvent(s,O):o.makeProperty(s,O)}):u.forEach(function(O){o.isFunction(s[O])?o.makeEvent(s,O):o.makeProperty(s,O)}),s},o.makeProperty=function(s,l){var g=o.getDecorator(s,l,!0);return g.type="property",g.instantiate(),g},o.makeEvent=function(s,l){var g=o.getDecorator(s,l,!0);return g.type="event",g.instantiate(),g},o.deserialize=function(s){return __awaiter(this,void 0,void 0,function(){var l,g,u,m,O,D,C,B,V,A,E,w,T,R,l,M,u,F,L,N,W,I,G,u,$,J,A,u,H,q,A,U,Q,X,Y,Z,ee;return __generator(this,function(te){switch(te.label){case 0:if("object"!=("undefined"==typeof s?"undefined":_typeof(s)))return[2,s];if(!s["@ObjectService.ObservableArray"])return[3,6];l=new ObservableArray,g=s.length,u=0,te.label=1;case 1:return u<g?(O=(m=l).push,[4,o.deserialize(s[u])]):[3,5];case 2:return[4,O.apply(m,[te.sent()])];case 3:te.sent(),te.label=4;case 4:return u++,[3,1];case 5:return[2,l];case 6:if(s["@ObjectService.GlobalType"])switch(s["@ObjectService.GlobalType"]){case"RegExp":return[2,new RegExp(s.source,s.flags)];case"Date":return[2,new Date(s.value)];}return s["@ObjectService.ModulePath"]&&s["@ObjectService.TypeName"]?(D=s["@ObjectService.ModulePath"],C=s["@ObjectService.TypeName"],[4,System.import(D)]):[3,22];case 7:for(w in B=te.sent(),V=B[C],A=new V,E=[],s)E.push(w);T=0,te.label=8;case 8:if(!(T<E.length))return[3,21];if(R=E[T],!!/^@ObjectService\./.test(R))return[3,16];if(!(A[R]&&A[R]["@ObjectService.ObservableArray"]&&Array.isArray(s[R])))return[3,13];l=s[R],M=A[R],u=0,te.label=9;case 9:return u<l.length?(L=(F=M).push,[4,o.deserialize(l[u])]):[3,12];case 10:L.apply(F,[te.sent()]),te.label=11;case 11:return u++,[3,9];case 12:return[3,16];case 13:return te.trys.push([13,15,,16]),N=A,W=R,[4,o.deserialize(s[R])];case 14:return N[W]=te.sent(),[3,16];case 15:return I=te.sent(),G=Object.getOwnPropertyDescriptor(A,R),G&&(console.log("writable: ",G.writable),console.log("get: ",!!G.get),console.log("set: ",!!G.set)),console.error("error at property: ",R,I),[3,16];case 16:if(!Array.isArray(s))return[3,20];u=0,te.label=17;case 17:return u<s.length?($=A,J=u,[4,o.deserialize(s[u])]):[3,20];case 18:$[J]=te.sent(),te.label=19;case 19:return u++,[3,17];case 20:return T++,[3,8];case 21:return[2,A];case 22:if(!Array.isArray(s))return[3,27];A=[],u=0,te.label=23;case 23:return u<s.length?(H=A,q=u,[4,o.deserialize(s[u])]):[3,26];case 24:H[q]=te.sent(),te.label=25;case 25:return u++,[3,23];case 26:return[2,A];case 27:for(Q in A={},U=[],s)U.push(Q);X=0,te.label=28;case 28:return X<U.length?(Y=U[X],Z=A,ee=Y,[4,o.deserialize(s[Y])]):[3,31];case 29:Z[ee]=te.sent(),te.label=30;case 30:return X++,[3,28];case 31:return[2,A];}})})},o.serializationReplacer=function(s,l){if(!l)return l;if(l["@ObjectService.ObservableArray"]){var g=l.map(function(C){return C});return g["@ObjectService.ObservableArray"]=!0,g}if(l["@ObjectService.ModulePath"]&&l["@ObjectService.TypeName"]){var u={};for(var m in l)switch(m){case"@ObjectService.Prototype":case"@ObjectService.Decorators":break;case"@ObjectService.ModulePath":u["@ObjectService.ModulePath"]=l[m];break;case"@ObjectService.TypeName":u["@ObjectService.TypeName"]=l[m];break;default:var O=o.getDecorator(l,m,!0);O||(u[m]=l[m]);}var S=l["@ObjectService.Decorators"];for(var D in S){var O=S[D];"property"==O.type&&void 0===u[D]&&(u[D]=O.RealValue)}return u}return l instanceof RegExp?{"@ObjectService.GlobalType":"RegExp",flags:l.flags,source:l.source}:l instanceof Date?{"@ObjectService.GlobalType":"Date",value:+l}:l},o.serialize=function(s){return JSON.stringify(s,o.serializationReplacer)},o.pack=function(s){function l(D){if(!D)return D;if("object"!=("undefined"==typeof D?"undefined":_typeof(D)))return D;if(D["@ObjectService.Reference"]){for(var C=0;C<u.length;C++)if(u[C]==D)return{"@ObjectService.Pointer":C};return u.push(D),{"@ObjectService.Pointer":u.length-1}}return D}function g(D,C){if(!C)return C;if(""!=D&&C["@ObjectService.Reference"])return l(C);if(C["@ObjectService.ObservableArray"]){var B=C.map(function(R){return R});return B["@ObjectService.ObservableArray"]=!0,B}if(C["@ObjectService.ModulePath"]&&C["@ObjectService.TypeName"]){var V={};for(var A in C)switch(A){case"@ObjectService.Prototype":case"@ObjectService.Decorators":case"@ObjectService.Reference":break;case"@ObjectService.ModulePath":V["@ObjectService.ModulePath"]=C[A];break;case"@ObjectService.TypeName":V["@ObjectService.TypeName"]=C[A];break;default:var E=o.getDecorator(C,A,!0);E||(V[A]=C[A]);}var w=C["@ObjectService.Decorators"];for(var T in w){var E=w[T];"property"==E.type&&void 0===V[T]&&(V[T]=E.RealValue)}return V}return C instanceof RegExp?{"@ObjectService.GlobalType":"RegExp",flags:C.flags,source:C.source}:C instanceof Date?{"@ObjectService.GlobalType":"Date",value:+C}:C}for(var S,u=[s],m=[],O=0;O<u.length;)S=u[O],m.push(JSON.stringify(S,g)),O+=1;return JSON.stringify(m)},o.unpack=function(s){return __awaiter(this,void 0,void 0,function(){var l,g;return __generator(this,function(u){switch(u.label){case 0:try{l=JSON.parse(s)}catch(m){return[2]}return"object"==("undefined"==typeof l?"undefined":_typeof(l))?Array.isArray(l)?(g=new Unpacker(l),[4,g.unpack()]):[2]:[2];case 1:return[2,u.sent()];}})})},o}();obs.syncFrom=function(o){var s=new memberDecorator;return s.syncFrom(o)},obs.updateTo=function(o){var s=new memberDecorator;return s.updateTo(o)},obs.statusStack=[],obs.disabled=!1,exports.obs=obs;var Unpacker=function(){function o(s){this.dict=s,this.instances={}}return o.prototype.unpack=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(s){switch(s.label){case 0:return[4,this.getInstance(0)];case 1:return[2,s.sent()];}})})},o.prototype.getInstance=function(s){return __awaiter(this,void 0,void 0,function(){var l;return __generator(this,function(g){switch(g.label){case 0:return this.instances[s]?[2,this.instances[s]]:this.dict[s]?(l=JSON.parse(this.dict[s]),[4,this.deserialize(l,s)]):[2,void 0];case 1:return[2,g.sent()];}})})},o.prototype.deserialize=function(s,l){return __awaiter(this,void 0,void 0,function(){var g,u,m,O,S,C,B,V,A,g,E,w,T,R,M,F,m,L,K,W,I,G,$,m,J,H,g,m,q,U,g,Q,X,Y,Z,ee,te;return __generator(this,function(re){switch(re.label){case 0:if("object"!=("undefined"==typeof s?"undefined":_typeof(s)))return[2,s];if(!s["@ObjectService.ObservableArray"])return[3,6];g=new ObservableArray,"number"==typeof l&&(this.instances[l]=g),u=s.length,m=0,re.label=1;case 1:return m<u?(S=(O=g).push,[4,this.deserialize(s[m])]):[3,5];case 2:return[4,S.apply(O,[re.sent()])];case 3:re.sent(),re.label=4;case 4:return m++,[3,1];case 5:return[2,g];case 6:if(s["@ObjectService.GlobalType"])switch(s["@ObjectService.GlobalType"]){case"RegExp":return[2,new RegExp(s.source,s.flags)];case"Date":return[2,new Date(s.value)];}return"number"==typeof s["@ObjectService.Pointer"]?[4,this.getInstance(s["@ObjectService.Pointer"])]:[3,8];case 7:return[2,re.sent()];case 8:return s["@ObjectService.ModulePath"]&&s["@ObjectService.TypeName"]?(C=s["@ObjectService.ModulePath"],B=s["@ObjectService.TypeName"],[4,System.import(C)]):[3,24];case 9:for(w in V=re.sent(),A=V[B],g=new A,"number"==typeof l&&(this.instances[l]=g),E=[],s)E.push(w);T=0,re.label=10;case 10:if(!(T<E.length))return[3,23];if(R=E[T],!!/^@ObjectService\./.test(R))return[3,18];if(!(g[R]&&g[R]["@ObjectService.ObservableArray"]&&Array.isArray(s[R])))return[3,15];M=s[R],F=g[R],m=0,re.label=11;case 11:return m<M.length?(K=(L=F).push,[4,obs.deserialize(M[m])]):[3,14];case 12:K.apply(L,[re.sent()]),re.label=13;case 13:return m++,[3,11];case 14:return[3,18];case 15:return re.trys.push([15,17,,18]),W=g,I=R,[4,this.deserialize(s[R])];case 16:return W[I]=re.sent(),[3,18];case 17:return G=re.sent(),$=Object.getOwnPropertyDescriptor(g,R),$&&(console.log("writable: ",$.writable),console.log("get: ",!!$.get),console.log("set: ",!!$.set)),console.error("error at property: ",R,G),[3,18];case 18:if(!Array.isArray(s))return[3,22];m=0,re.label=19;case 19:return m<s.length?(J=g,H=m,[4,this.deserialize(s[m])]):[3,22];case 20:J[H]=re.sent(),re.label=21;case 21:return m++,[3,19];case 22:return T++,[3,10];case 23:return[2,g];case 24:if(!Array.isArray(s))return[3,29];g=[],"number"==typeof l&&(this.instances[l]=g),m=0,re.label=25;case 25:return m<s.length?(q=g,U=m,[4,this.deserialize(s[m])]):[3,28];case 26:q[U]=re.sent(),re.label=27;case 27:return m++,[3,25];case 28:return[2,g];case 29:for(X in g={},"number"==typeof l&&(this.instances[l]=g),Q=[],s)Q.push(X);Y=0,re.label=30;case 30:return Y<Q.length?(Z=Q[Y],ee=g,te=Z,[4,this.deserialize(s[Z])]):[3,33];case 31:ee[te]=re.sent(),re.label=32;case 32:return Y++,[3,30];case 33:return[2,g];}})})},o}(),PathBindingMode;(function(o){o[o.bind=0]="bind",o[o.syncFrom=1]="syncFrom",o[o.updateTo=2]="updateTo"})(PathBindingMode=exports.PathBindingMode||(exports.PathBindingMode={}));var ArrExt=function(){function o(){}return o.prototype.add=function(s){var l=this;return l.push(s),s},o.prototype.insert=function(s,l){var g=this;return g.push(l),l},o.prototype.push=function(){for(var s=[],l=0;l<arguments.length;l++)s[l]=arguments[l];var g=this,u=o.$push.apply(g,s);return u},o.prototype.pop=function(){var s=this,l=o.$pop.apply(this,[]);return l},o}(),ObservableArray=ObservableArray_1=function(o){function s(){for(var l=[],g=0;g<arguments.length;g++)l[g]=arguments[g];var u=o.call(this)||this;return u.inOverwrittenOperation=!1,u.childDefaultChanged=function(m,O,S,D,C){C&&0<C.length&&u.forEach(function(B){obp.setPathValue(B,C,void 0,u,"childDefaultPath")}),D&&0<D.length&&u.forEach(function(B){obp.setPathValue(B,D,u,u,"childDefaultPath")})},u.childrenListenPaths=[],u.itemListeners=[],u.itemEvents=new EventProxy,Object.defineProperty(u,"@ObjectService.ObservableArray",{configurable:!1,enumerable:!0,value:!0,writable:!1}),Array.prototype.push.apply(u,l),Array.prototype.push.apply(u.itemListeners,l.map(function(m){return new itemListener(u,m,u.childrenListenPaths)})),u}return __extends(s,o),s.prototype.push=function(){for(var l=this,g=[],u=0;u<arguments.length;u++)g[u]=arguments[u];this.inOverwrittenOperation=!0;var m=Array.prototype.push.apply(this,g);return this.inOverwrittenOperation=!1,Array.prototype.push.apply(this.itemListeners,g.map(function(O){return new itemListener(l,O,l.childrenListenPaths)})),this.childDefaultPath&&0<this.childDefaultPath.length&&g.forEach(function(O){obp.setPathValue(O,l.childDefaultPath,l,l,"childDefaultPath")}),this.onchange&&this.onchange({array:this,items:g,operation:ArrayOperationType.push}),m},s.prototype.pop=function(){this.inOverwrittenOperation=!0;var l=Array.prototype.pop.apply(this,[]);return this.inOverwrittenOperation=!1,this.itemListeners.pop(),this.childDefaultPath&&0<this.childDefaultPath.length&&obp.setPathValue(l,this.childDefaultPath,void 0,this,"childDefaultPath"),this.onchange&&this.onchange({array:this,items:[l],operation:ArrayOperationType.pop}),l},s.prototype.unshift=function(){for(var l=this,g=[],u=0;u<arguments.length;u++)g[u]=arguments[u];this.inOverwrittenOperation=!0;var m=Array.prototype.unshift.apply(this,g);return this.inOverwrittenOperation=!1,Array.prototype.unshift.apply(this.itemListeners,g.map(function(O){return new itemListener(l,O,l.childrenListenPaths)})),this.childDefaultPath&&0<this.childDefaultPath.length&&g.forEach(function(O){obp.setPathValue(O,l.childDefaultPath,l,l,"childDefaultPath")}),this.onchange&&this.onchange({array:this,items:g,operation:ArrayOperationType.unshift}),m},s.prototype.shift=function(){this.inOverwrittenOperation=!0;var l=Array.prototype.shift.apply(this,[]);return this.inOverwrittenOperation=!1,this.itemListeners.shift(),this.childDefaultPath&&0<this.childDefaultPath.length&&obp.setPathValue(l,this.childDefaultPath,void 0,this,"childDefaultPath"),this.onchange&&this.onchange({array:this,items:[l],operation:ArrayOperationType.shift}),l},s.prototype.splice=function(l,g){for(var u=this,m=[],O=2;O<arguments.length;O++)m[O-2]=arguments[O];var S=[l,g];Array.prototype.push.apply(S,m),this.inOverwrittenOperation=!0;var D=Array.prototype.splice.apply(this,S);this.inOverwrittenOperation=!1;var C=[l,g];return Array.prototype.push.apply(C,m.map(function(B){return new itemListener(u,B,u.childrenListenPaths)})),Array.prototype.splice.apply(this.itemListeners,C),this.childDefaultPath&&0<this.childDefaultPath.length&&(m.forEach(function(B){obp.setPathValue(B,u.childDefaultPath,u,u,"childDefaultPath")}),D.forEach(function(B){obp.setPathValue(B,u.childDefaultPath,void 0,u,"childDefaultPath")})),this.onchange&&this.onchange({array:this,items:m,operation:ArrayOperationType.splice,startIndex:l,spliceDeleteCount:g}),D},s.prototype.sort=function(l){l||(l=function(V,A){return V.toString()>A.toString()?1:-1});for(var g={},u=this.length,m=0;m<u;m++)g[m]=m;for(var m=u-1;0<=m;m--)for(var O=1;O<=m;O++)if(0<l(this[g[O-1]],this[g[O]])){var S=g[O-1];g[O-1]=g[O],g[O]=S}this.inOverwrittenOperation=!0;for(var D=Array.prototype.splice.apply(this,[0,u]),C=this.itemListeners.splice(0,this.itemListeners.length),m=0;m<u;m++)Array.prototype.push.apply(this,[D[g[m]]]),this.itemListeners.push(C[g[m]]);return this.inOverwrittenOperation=!1,this.onchange&&this.onchange({array:this,items:this,operation:ArrayOperationType.configure,mappings:g}),this},s.prototype.clear=function(){var l=this;this.inOverwrittenOperation=!0;var g=this.splice(0,this.length);return this.inOverwrittenOperation=!1,this.itemListeners.splice(0,this.itemListeners.length),this.childDefaultPath&&0<this.childDefaultPath.length&&g.forEach(function(u){obp.setPathValue(u,l.childDefaultPath,void 0,l,"childDefaultPath")}),this.onchange&&this.onchange({array:this,items:g,operation:ArrayOperationType.splice,startIndex:0,spliceDeleteCount:g.length}),g},s.prototype.reverse=function(){for(var l={},g=this.length,u=0;u<g;u++)l[u]=g-u-1;this.inOverwrittenOperation=!0;for(var m=Array.prototype.splice.apply(this,[0,g]),u=0;u<g;u++)this.push(m[l[u]]);return this.inOverwrittenOperation=!1,this.itemListeners.reverse(),this.onchange&&this.onchange({array:this,items:this,operation:ArrayOperationType.configure,mappings:l}),this},s.prototype.asArray=function(){return this.slice(0,this.length)},s.prototype.avatarize=function(l,g){var u=this;this.avatarizer=g,l.forEach(function(m){Array.prototype.push(u.avatarizer(m))})},s.prototype.observationSourceChanged=function(l,g,u,m){if(this.observationTrigger&&(this.observationTrigger.target=void 0),this.observationTrigger={target:this,method:this.observe},obs.isObservableArray(m)){var S=obs.getDecorator(m,"onchange",!0);S&&S.afters.push(this.observationTrigger)}this.observe(this.observationSource,"onchange",[],{array:this.observationSource,items:this.observationSource,operation:ArrayOperationType.reset})},s.prototype.observe=function(l,g,u,m){var O=function(E){return E};this.observer&&(O=this.observer);var S=this.observationSource;if(!S||!obs.isObservableArray(S)){var D=[0,this.length];return Array.prototype.splice.apply(this,D),void(this.onchange&&this.onchange({array:this,items:this,operation:ArrayOperationType.reset}))}if(!m||!m.array||!m.operation){var D=[0,this.length];return D.push.apply(D,this.observationSource.map(function(A){return O(A)})),Array.prototype.splice.apply(this,D),void(this.onchange&&this.onchange({array:this,items:this,operation:ArrayOperationType.reset}))}switch(m.operation){default:case ArrayOperationType.reset:var D=[0,this.length];D.push.apply(D,this.observationSource.map(function(A){return O(A)})),Array.prototype.splice.apply(this,D),this.onchange&&this.onchange({array:this,items:this,operation:ArrayOperationType.reset});break;case ArrayOperationType.replace:this[m.startIndex]=O(m.items[0]);break;case ArrayOperationType.delete:delete this[m.startIndex];break;case ArrayOperationType.push:this.push.apply(this,m.items.map(function(A){return O(A)}));break;case ArrayOperationType.pop:this.pop();break;case ArrayOperationType.unshift:this.unshift.apply(this,m.items.map(function(A){return O(A)}));break;case ArrayOperationType.shift:this.shift();break;case ArrayOperationType.splice:var C=[m.startIndex,m.spliceDeleteCount];m.items&&C.push.apply(C,m.items.map(function(A){return O(A)})),this.splice.apply(this,C);break;case ArrayOperationType.configure:for(var B=[0,this.length],V=0;V<m.array.length;V++)B.push(this[m.mappings[V]]);Array.prototype.splice.apply(this,B),this.onchange&&this.onchange({array:this,items:this,operation:ArrayOperationType.configure,mappings:m.mappings});}},s.prototype.populationTargetChanged=function(l,g,u,m,O){O&&O.splice(0,O.length),this.populate(this.populationTarget,"onchange",[],{array:this,items:this,operation:ArrayOperationType.reset})},s.prototype.populate=function(l,g,u,m){var O=function(E){return E};this.populator&&(O=this.populator);var S=this.populationTarget;if(S){if(!m||!m.array||!m.operation){var D=[0,S.length];return D.push.apply(D,this.map(function(A){return O(A)})),void S.splice.apply(S,D)}switch(m.operation){default:case ArrayOperationType.reset:var D=[0,S.length];D.push.apply(D,this.map(function(A){return O(A)})),S.splice.apply(S,D);break;case ArrayOperationType.replace:S[m.startIndex]=O(m.items[0]);break;case ArrayOperationType.delete:delete S[m.startIndex];break;case ArrayOperationType.push:S.push.apply(S,m.items.map(function(A){return O(A)}));break;case ArrayOperationType.pop:S.pop();break;case ArrayOperationType.unshift:this.unshift.apply(this,m.items.map(function(A){return O(A)}));break;case ArrayOperationType.shift:S.shift();break;case ArrayOperationType.splice:var C=[m.startIndex,m.spliceDeleteCount];m.items&&C.push.apply(C,m.items.map(function(A){return O(A)})),S.splice.apply(S,C);break;case ArrayOperationType.configure:for(var B=[0,S.length],V=0;V<this.length;V++)B.push(S[m.mappings[V]]);S.splice.apply(S,B);}}},s.prototype.listenChildren=function(){for(var l=[],g=0;g<arguments.length;g++)l[g]=arguments[g];Array.prototype.push.apply(this.childrenListenPaths,l),this.itemListeners.forEach(function(u){return l.forEach(function(m){return u.addPath(m)})})},s}(Array);__decorate([obs.after(function(){return ObservableArray_1.prototype.populate}).event,__metadata("design:type",Function)],ObservableArray.prototype,"onchange",void 0),__decorate([obs.property,__metadata("design:type",Object)],ObservableArray.prototype,"parent",void 0),__decorate([obs.after(function(){return ObservableArray_1.prototype.childDefaultChanged}).property,__metadata("design:type",Array)],ObservableArray.prototype,"childDefaultPath",void 0),__decorate([obs.event,__metadata("design:type",Object)],ObservableArray.prototype,"childDefaultChanged",void 0),__decorate([obs.after(function(){return ObservableArray_1.prototype.observationSourceChanged}).property,__metadata("design:type",ObservableArray)],ObservableArray.prototype,"observationSource",void 0),__decorate([obs.method,__metadata("design:type",Function),__metadata("design:paramtypes",[Object,String,Array,ObservableArray,ObservableArray]),__metadata("design:returntype",void 0)],ObservableArray.prototype,"observationSourceChanged",null),__decorate([obs.after(function(){return ObservableArray_1.prototype.populate}).property,__metadata("design:type",Function)],ObservableArray.prototype,"observer",void 0),__decorate([obs.event,__metadata("design:type",Function),__metadata("design:paramtypes",[Object,String,Array,Object]),__metadata("design:returntype",void 0)],ObservableArray.prototype,"observe",null),__decorate([obs.after(function(){return ObservableArray_1.prototype.populationTargetChanged}).property,__metadata("design:type",Array)],ObservableArray.prototype,"populationTarget",void 0),__decorate([obs.method,__metadata("design:type",Function),__metadata("design:paramtypes",[Object,String,Array,ObservableArray,ObservableArray]),__metadata("design:returntype",void 0)],ObservableArray.prototype,"populationTargetChanged",null),__decorate([obs.after(function(){return ObservableArray_1.prototype.observe}).property,__metadata("design:type",Function)],ObservableArray.prototype,"populator",void 0),__decorate([obs.event,__metadata("design:type",Function),__metadata("design:paramtypes",[Object,String,Array,Object]),__metadata("design:returntype",void 0)],ObservableArray.prototype,"populate",null),__decorate([obs.property,__metadata("design:type",Object)],ObservableArray.prototype,"itemEvents",void 0),ObservableArray=ObservableArray_1=__decorate([obs.bindable,__metadata("design:paramtypes",[Object])],ObservableArray),exports.ObservableArray=ObservableArray;var itemListener=function(){return function(s,l,g){var u=this;this.parent=s,this.item=l,this.listeners={},this.addPath=function(O){var S=new pathListener(u,O),D=O.join("");if(u.listeners[D]){var C=u.listeners[D];C.clear(),C.parent=void 0}u.listeners[D]=S,S.listen()},this.removePath=function(O){var S=O.join("");if(u.listeners[S]){var D=u.listeners[S];D.clear(),D.parent=void 0,u.listeners[S]=void 0}},this.item=l;var m=this;g.forEach(function(O){return m.addPath(O)})}}();exports.itemListener=itemListener;var pathListener=function(){return function(s,l){var g=this;this.parent=s,this.path=l,this.listen=function(){if(g.parent&&g.parent.item&&g.parent.parent&&g.parent.parent.itemEvents&&g.path&&0<g.path.length){var u=obp.getPathSourceKeyValue(g.parent.item,g.path);if(u&&u.source&&u.key){var m=obs.getDecorator(u.source,u.key,!0),O=obs.getDecorator(g.parent.parent.itemEvents,obp.getEventProxyPath(g.path));if(m&&"event"==m.type){g.trigger={target:g.parent.parent.itemEvents,method:O.handler},m.afters.push(g.trigger)}else g.target=u.source,g.property=u.key,g.target[g.property]=O.invoker}g.path&&0<g.path.length&&(g.pathChanged={target:g,method:g.onPathChanged}),obp.setPathChangedTrigger(g.parent.item,g.path,g.pathChanged)}},this.clear=function(){g.pathChanged&&(g.pathChanged.target=void 0,g.pathChanged.method=void 0,g.pathChanged=void 0),g.target&&g.property&&(g.target[g.property]=void 0),g.target=void 0,g.property=void 0,g.trigger&&(g.trigger.target=void 0,g.trigger.method=void 0,g.trigger=void 0)},this.onPathChanged=function(){g.clear(),g.listen()}}}();exports.pathListener=pathListener;var EventProxy=function(){return function(){this["@ObjectService.EventProxy"]=!0,this["@ObjectService.Decorators"]={}}}();exports.EventProxy=EventProxy;var ArrayOperationType;(function(o){o[o["null"]=0]="null",o[o.reset=1]="reset",o[o.replace=2]="replace",o[o["delete"]=3]="delete",o[o.push=4]="push",o[o.pop=5]="pop",o[o.unshift=6]="unshift",o[o.shift=7]="shift",o[o.splice=8]="splice",o[o.configure=9]="configure"})(ArrayOperationType=exports.ArrayOperationType||(exports.ArrayOperationType={}));var BindableTest;(function(){var l,g,u,m,O,S,D,C,B,A,V,w,R,M,F,L,K;var W,I})(BindableTest||(BindableTest={}));var ObservableTest;(function(){var l,g,u,m,O,S;var C})(ObservableTest||(ObservableTest={}));var PathChangeTest;(function(){var l,g,u,m;var O})(PathChangeTest||(PathChangeTest={}));var ListenTest;(function(){var l,g,u,m;var O})(ListenTest||(ListenTest={}));var decoratorlist=[],inheritTest;(function(){var l,g,u,m;var O,S})(inheritTest||(inheritTest={}));var observeTest;(function(){var l,g,u;var m})(observeTest||(observeTest={}));var ObservableArray_1;