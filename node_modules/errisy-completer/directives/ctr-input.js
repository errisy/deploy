"use strict";var __decorate=this&&this.__decorate||function(a,b,e,f){var j,g=arguments.length,h=3>g?b:null===f?f=Object.getOwnPropertyDescriptor(b,e):f;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)h=Reflect.decorate(a,b,e,f);else for(var l=a.length-1;0<=l;l--)(j=a[l])&&(h=(3>g?j(h):3<g?j(b,e,h):j(b,e))||h);return 3<g&&h&&Object.defineProperty(b,e,h),h},__metadata=this&&this.__metadata||function(a,b){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(a,b)},__param=this&&this.__param||function(a,b){return function(e,f){b(e,f,a)}},core_1=require("@angular/core"),ctr_completer_1=require("./ctr-completer"),KEY_DW=40,KEY_RT=39,KEY_UP=38,KEY_LF=37,KEY_ES=27,KEY_EN=13,KEY_TAB=9,CtrInput=function(){function a(b){var e=this;this.completer=b,this.clearSelected=!1,this.overrideSuggested=!1,this.ngModelChange=new core_1.EventEmitter,this._searchStr="",this._displayStr="",this._selectedItem=null,this.completer.selected.subscribe(function(f){e._selectedItem=f,f&&(e.searchStr=e.clearSelected?"":f.title,e.ngModelChange.emit(e.searchStr))}),this.completer.highlighted.subscribe(function(f){e._displayStr=f.title,e.ngModelChange.emit(f.title)})}return a.prototype.onInputChange=function(b){this.searchStr=b.target.value},a.prototype.keyupHandler=function(b){if(b.keyCode!==KEY_LF&&b.keyCode!==KEY_RT&&b.keyCode!==KEY_TAB)if(b.keyCode===KEY_UP||b.keyCode===KEY_EN)b.preventDefault();else if(b.keyCode===KEY_DW)b.preventDefault(),this.completer.search(this.searchStr);else if(b.keyCode===KEY_ES)this._searchStr=this._displayStr,this.completer.clear();else{if(!this.searchStr)return void this.completer.clear();this.completer.search(this.searchStr)}},a.prototype.keydownHandler=function(b){b.keyCode===KEY_EN?(this.completer.hasHighlited()&&b.preventDefault(),this.completer.selectCurrent()):b.keyCode===KEY_DW?(b.preventDefault(),this.completer.nextRow()):b.keyCode===KEY_UP?(b.preventDefault(),this.completer.prevRow()):b.keyCode===KEY_TAB?this.overrideSuggested&&this._selectedItem?this.completer.onSelected({title:this.searchStr,originalObject:null}):this.completer.selectCurrent():b.keyCode===KEY_ES&&b.preventDefault()},a.prototype.onBlur=function(){var e=this;setTimeout(function(){e.overrideSuggested&&e.completer.onSelected({title:e.searchStr,originalObject:null}),e.completer.clear()},200)},Object.defineProperty(a.prototype,"searchStr",{get:function(){return this._searchStr},set:function(b){this._searchStr=b,this._displayStr=b},enumerable:!0,configurable:!0}),a}();__decorate([core_1.Input("clearSelected"),__metadata("design:type",Object)],CtrInput.prototype,"clearSelected",void 0),__decorate([core_1.Input("overrideSuggested"),__metadata("design:type",Object)],CtrInput.prototype,"overrideSuggested",void 0),__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],CtrInput.prototype,"ngModelChange",void 0),__decorate([core_1.HostListener("input",["$event"]),__metadata("design:type",Function),__metadata("design:paramtypes",[Object]),__metadata("design:returntype",void 0)],CtrInput.prototype,"onInputChange",null),__decorate([core_1.HostListener("keyup",["$event"]),__metadata("design:type",Function),__metadata("design:paramtypes",[Object]),__metadata("design:returntype",void 0)],CtrInput.prototype,"keyupHandler",null),__decorate([core_1.HostListener("keydown",["$event"]),__metadata("design:type",Function),__metadata("design:paramtypes",[Object]),__metadata("design:returntype",void 0)],CtrInput.prototype,"keydownHandler",null),__decorate([core_1.HostListener("blur",["$event"]),__metadata("design:type",Function),__metadata("design:paramtypes",[Object]),__metadata("design:returntype",void 0)],CtrInput.prototype,"onBlur",null),CtrInput=__decorate([core_1.Directive({selector:"[ctrInput]"}),__param(0,core_1.Host()),__metadata("design:paramtypes",[ctr_completer_1.CtrCompleter])],CtrInput),exports.CtrInput=CtrInput;