"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},__decorate=function(a,b,g,h){var m,j=arguments.length,l=3>j?b:null===h?h=Object.getOwnPropertyDescriptor(b,g):h;if("object"===("undefined"==typeof Reflect?"undefined":_typeof(Reflect))&&"function"==typeof Reflect.decorate)l=Reflect.decorate(a,b,g,h);else for(var o=a.length-1;0<=o;o--)(m=a[o])&&(l=(3>j?m(l):3<j?m(b,g,l):m(b,g))||l);return 3<j&&l&&Object.defineProperty(b,g,l),l},__metadata=function(a,b){if("object"===("undefined"==typeof Reflect?"undefined":_typeof(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(a,b)},__awaiter=function(a,b,g,h){return new(g||(g=Promise))(function(j,l){function m(q){try{p(h.next(q))}catch(s){l(s)}}function o(q){try{p(h["throw"](q))}catch(s){l(s)}}function p(q){q.done?j(q.value):new g(function(s){s(q.value)}).then(m,o)}p((h=h.apply(a,b)).next())})},__generator=function(a,b){function g(p){return function(q){return h([p,q])}}function h(p){if(l)throw new TypeError("Generator is already executing.");for(;j;)try{if(l=1,m&&(o=m[2&p[0]?"return":p[0]?"throw":"next"])&&!(o=o.call(m,p[1])).done)return o;switch((m=0,o)&&(p=[0,o.value]),p[0]){case 0:case 1:o=p;break;case 4:return j.label++,{value:p[1],done:!1};case 5:j.label++,m=p[1],p=[0];continue;case 7:p=j.ops.pop(),j.trys.pop();continue;default:if((o=j.trys,!(o=0<o.length&&o[o.length-1]))&&(6===p[0]||2===p[0])){j=0;continue}if(3===p[0]&&(!o||p[1]>o[0]&&p[1]<o[3])){j.label=p[1];break}if(6===p[0]&&j.label<o[1]){j.label=o[1],o=p;break}if(o&&j.label<o[2]){j.label=o[2],j.ops.push(p);break}o[2]&&j.ops.pop(),j.trys.pop();continue;}p=b.call(a,j)}catch(q){p=[6,q],m=0}finally{l=o=0}if(5&p[0])throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}var l,m,o,j={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return{next:g(0),"throw":g(1),"return":g(2)}},core_1=require("@angular/core"),util=require("errisy-util"),errisy_bindable_1=require("errisy-bindable"),ModelField=function(){function a(){}return a.prototype.event=function(b,g,h){this.EventChecks||(this.EventChecks={}),this.EventChecks[b]||(this.EventChecks[b]=[]);var j=this.EventChecks[b];return j.push({invoker:{host:g,method:h}}),this},a.prototype.id=function(b){return this.ID=b,this},a.prototype.verify=function(b){return this.Verification||(this.Verification=[]),this.Verification.push({verify:b}),this},a.prototype.contextVerify=function(b,g){return this.Verification||(this.Verification=[]),this.Verification.push({invoker:{host:b,method:g}}),this},a.prototype.readonly=function(){return this.IsReadOnly=!0,this},a.prototype.valueModel=function(b){return this.ValueModel=b,this},a.prototype.statusModel=function(b){return this.StatusModel=b,this},a.prototype.ref=function(b,g){return this.referenceHost=b,this.referencePath=errisy_bindable_1.obp.analyzePath(g),this},a.prototype.attr=function(b){return this.attributes=b,this},a.prototype.css=function(b){return this.styles=b,this},a.prototype.default=function(b){return this.defaultValue=b,this},a}();exports.ModelField=ModelField;var FieldViewBase=function(){function a(b,g,h){this.renderer=b,this.parent=g,this.changeDetectorRef=h,this._listenersReady=!1}return Object.defineProperty(a.prototype,"ID",{get:function(){return this._modelField?this._modelField.ID:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"Name",{get:function(){return this._modelField?this._modelField.Name:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"Value",{get:function(){if(this._modelField&&this._modelField.ValueModel)return this._modelField.ValueModel.Value;var g=this.parent.parent.Entity;if(g&&this._modelField)return void 0==g[this._modelField.Name]&&this._modelField.defaultValue?this._modelField.defaultValue:g[this._modelField.Name]},set:function(g){if(this._modelField&&this._modelField.ValueModel)return void(this._modelField.ValueModel.Value=g);var h=this.parent.parent.Entity;h&&this._modelField&&(h[this._modelField.Name]=g)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"Status",{get:function(){return this._modelField&&this._modelField.StatusModel?this._modelField.StatusModel.Value:this._status},set:function(g){this._modelField&&this._modelField.StatusModel&&(this._modelField.StatusModel.Value=g),this._status=g},enumerable:!0,configurable:!0}),a.prototype.Save=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(b){switch(b.label){case 0:return[4,this.parent.parent.Save()];case 1:return b.sent(),[2];}})})},Object.defineProperty(a.prototype,"Title",{get:function(){return this._modelField&&this._modelField.Title?this._modelField.Title:""},set:function(g){this._modelField&&(this._modelField.Title=g)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"Model",{get:function(){return this._modelField},set:function(g){this._modelField=g,this.SetupModel()},enumerable:!0,configurable:!0}),a.prototype.SetupModel=function(){if(this._modelField&&this._modelField.referenceHost&&this._modelField.referencePath&&errisy_bindable_1.obp.setPathValue(this._modelField.referenceHost,this._modelField.referencePath,this,this,"reference"),this.Input&&this._modelField.ID){var b=this.Input.nativeElement;b.setAttribute("id",this._modelField.ID)}this.AdditionalModelSetup&&this.AdditionalModelSetup(),this.SetupListeners()},Object.defineProperty(a.prototype,"pattern",{get:function(){return this._modelField&&this._modelField.attributes&&this._modelField.attributes.pattern?this._modelField.attributes.pattern:""},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"min",{get:function(){return this._modelField&&this._modelField.attributes&&this._modelField.attributes.min?this._modelField.attributes.min:""},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"max",{get:function(){return this._modelField&&this._modelField.attributes&&this._modelField.attributes.max?this._modelField.attributes.max:""},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"maxlength",{get:function(){return this._modelField&&this._modelField.attributes&&this._modelField.attributes.maxlength?this._modelField.attributes.maxlength:""},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"Link",{get:function(){return this._modelField&&this._modelField.HrefLink?this._modelField.HrefLink:""},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"isReadOnly",{get:function(){return this._modelField&&this._modelField.IsReadOnly||this.parent.parent.isReadOnly},enumerable:!0,configurable:!0}),a.prototype.ngAfterViewInit=function(){},a.prototype.ngModelChange=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(g){switch(g.label){case 0:return this.onModelChange?[4,this.onModelChange(this.Value)]:[3,2];case 1:g.sent(),g.label=2;case 2:return this.parent.parent.Changed=!0,[2];}})})},a.prototype.ngInput=function(b){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(g){switch(g.label){case 0:return this.onInput?[4,this.onInput(b)]:[3,2];case 1:g.sent(),g.label=2;case 2:return[2];}})})},a.prototype.ngBlur=function(b){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(g){switch(g.label){case 0:return this.onBlur?[4,this.onBlur(b)]:[3,2];case 1:g.sent(),g.label=2;case 2:return[2];}})})},a.prototype.SetupListeners=function(){if(!this._listenersReady&&this._modelField.EventChecks){var b=this,g=function(m){switch(m){case"blur":h.onBlur=function(o){return __awaiter(this,void 0,void 0,function(){var p,q,s,u,u,w,u;return __generator(this,function(x){switch(x.label){case 0:p=b._modelField.EventChecks[m],q=0,x.label=1;case 1:return q<p.length?(s=p[q],s.handler?[4,s.handler(o,b)]:[3,3]):[3,8];case 2:if(u=x.sent(),u&&u.Status&&(b.Status=u.Status),u&&!u.Result)return[2,{Result:!1,Status:b.Status}];x.label=3;case 3:return s.check?[4,s.check(b.Value)]:[3,5];case 4:if(u=x.sent(),u&&u.Status&&(b.Status=u.Status),u&&!u.Result)return[2,{Result:!1,Status:b.Status}];x.label=5;case 5:return s.invoker?(w=s.invoker,w.host&&w.method?[4,w.method.apply(w.host,[o,b])]:[3,7]):[3,7];case 6:if(u=x.sent(),u&&u.Status&&(b.Status=u.Status),u&&!u.Result)return[2,{Result:!1,Status:b.Status}];x.label=7;case 7:return q++,[3,1];case 8:return[2];}})})};break;case"ngModelChange":h.onModelChange=function(o){return __awaiter(this,void 0,void 0,function(){var p,q,s,u,u,w,u;return __generator(this,function(x){switch(x.label){case 0:p=b._modelField.EventChecks[m],q=0,x.label=1;case 1:return q<p.length?(s=p[q],s.handler?[4,s.handler(o,b)]:[3,3]):[3,8];case 2:if(u=x.sent(),u&&u.Status&&(b.Status=u.Status),u&&!u.Result)return[2,{Result:!1,Status:b.Status}];x.label=3;case 3:return s.check?[4,s.check(b.Value)]:[3,5];case 4:if(u=x.sent(),u&&u.Status&&(b.Status=u.Status),u&&!u.Result)return[2,{Result:!1,Status:b.Status}];x.label=5;case 5:return s.invoker?(w=s.invoker,w.host&&w.method?[4,w.method.apply(w.host,[b.Value,b])]:[3,7]):[3,7];case 6:if(u=x.sent(),u&&u.Status&&(b.Status=u.Status),u&&!u.Result)return[2,{Result:!1,Status:b.Status}];x.label=7;case 7:return q++,[3,1];case 8:return[2];}})})};break;case"input":h.onInput=function(o){return __awaiter(this,void 0,void 0,function(){var p,q,s,u,u,w,u;return __generator(this,function(x){switch(x.label){case 0:p=b._modelField.EventChecks[m],q=0,x.label=1;case 1:return q<p.length?(s=p[q],s.handler?[4,s.handler(o,b)]:[3,3]):[3,8];case 2:if(u=x.sent(),u&&u.Status&&(b.Status=u.Status),u&&!u.Result)return[2,{Result:!1,Status:b.Status}];x.label=3;case 3:return s.check?[4,s.check(b.Value)]:[3,5];case 4:if(u=x.sent(),u&&u.Status&&(b.Status=u.Status),u&&!u.Result)return[2,{Result:!1,Status:b.Status}];x.label=5;case 5:return s.invoker?(w=s.invoker,w.host&&w.method?[4,w.method.apply(w.host,[o,b])]:[3,7]):[3,7];case 6:if(u=x.sent(),u&&u.Status&&(b.Status=u.Status),u&&!u.Result)return[2,{Result:!1,Status:b.Status}];x.label=7;case 7:return q++,[3,1];case 8:return[2];}})})};break;default:if(h.SetupSpecificEventListeners(m,b._modelField.EventChecks[m]))break;h.renderer.listen(h.Input.nativeElement,m,function(o){return __awaiter(this,void 0,void 0,function(){var p,q,s,u,u,w,u;return __generator(this,function(x){switch(x.label){case 0:p=b._modelField.EventChecks[m],q=0,x.label=1;case 1:return q<p.length?(s=p[q],s.handler?[4,s.handler(o,b)]:[3,3]):[3,8];case 2:if(u=x.sent(),u&&u.Status&&(b.Status=u.Status),u&&!u.Result)return[2,{Result:!1,Status:b.Status}];x.label=3;case 3:return s.check?[4,s.check(b.Value)]:[3,5];case 4:if(u=x.sent(),u&&u.Status&&(b.Status=u.Status),u&&!u.Result)return[2,{Result:!1,Status:b.Status}];x.label=5;case 5:return s.invoker?(w=s.invoker,w.host&&w.method?[4,w.method.apply(w.host,[o,b])]:[3,7]):[3,7];case 6:if(u=x.sent(),u&&u.Status&&(b.Status=u.Status),u&&!u.Result)return[2,{Result:!1,Status:b.Status}];x.label=7;case 7:return q++,[3,1];case 8:return[2];}})})});}},h=this;for(var j in this._modelField.EventChecks)g(j);this._listenersReady=!0}},a.prototype.SetupSpecificEventListeners=function(){return!1},a.prototype.Verify=function(){return __awaiter(this,void 0,void 0,function(){var b,g,h,j,h;return __generator(this,function(l){switch(l.label){case 0:if(!this._modelField||!this._modelField.Verification)return[2,!0];b=0,l.label=1;case 1:return b<this._modelField.Verification.length?(g=this._modelField.Verification[b],g.verify?[4,g.verify(this.Value)]:[3,3]):[3,6];case 2:if(h=l.sent(),h&&!h.Result)return this.Status=h.Status,[2,!1];l.label=3;case 3:return g.invoker?(j=g.invoker,j.host&&j.method?[4,j.method.apply(j.host,[this.Value])]:[3,5]):[3,5];case 4:if(h=l.sent(),h&&!h.Result)return this.Status=h.Status,[2,!1];l.label=5;case 5:return b++,[3,1];case 6:return this.Status=void 0,[2,!0];}})})},a}();__decorate([core_1.ViewChild("input"),__metadata("design:type",core_1.ElementRef)],FieldViewBase.prototype,"Input",void 0),exports.FieldViewBase=FieldViewBase;var ValueModel=function(){return function(){}}();exports.ValueModel=ValueModel;var StatusModel=function(){return function(){}}();exports.StatusModel=StatusModel;var OptionsModel=function(){return function(){this.Values=[]}}();exports.OptionsModel=OptionsModel;var IOption=function(){return function(){}}();exports.IOption=IOption;var NewPasswordModel=function(){function a(){this._model1=new ValueModel,this._model2=new ValueModel,this.StatusModel=new StatusModel}return Object.defineProperty(a.prototype,"Value",{get:function(){return util.isValidNotNullString(this._model1.Value)&&util.isValidNotNullString(this._model2.Value)&&!0==this.checkPassword().Result?this._model1.Value:void 0},set:function(){},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"Valid",{get:function(){return util.isValidNotNullString(this._model1.Value)&&util.isValidNotNullString(this._model2.Value)&&!0==this.checkPassword().Result},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"Model1",{get:function(){return this._model1},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"Model2",{get:function(){return this._model2},enumerable:!0,configurable:!0}),a.prototype.checkEmpty=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(){return this._model1.Value&&this._model2.Value?[2,{Result:!0,Status:void 0}]:[2,{Result:!1,Status:"Empty!"}]})})},a.prototype.asyncCheckPassword=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(){return[2,this.checkPassword()]})})},a.prototype.checkPassword=function(){if(this._model1.Value==this._model2.Value){var b=util.checkPasswordStrength(this._model1.Value);return 60>b.strength?{Result:!1,Status:"("+Math.round(b.strength)+")"+b.suggestion}:{Result:!0,Status:"("+Math.round(b.strength)+")"+b.suggestion}}return{Result:!1,Status:"Not matching!"}},a}();exports.NewPasswordModel=NewPasswordModel;