'use strict';var isArray_1=require('./util/isArray'),isObject_1=require('./util/isObject'),isFunction_1=require('./util/isFunction'),tryCatch_1=require('./util/tryCatch'),errorObject_1=require('./util/errorObject'),UnsubscriptionError_1=require('./util/UnsubscriptionError'),Subscription=function(){function a(b){this.closed=!1,b&&(this._unsubscribe=b)}return a.prototype.unsubscribe=function(){var c,b=!1;if(!this.closed){this.closed=!0;var d=this,e=d._unsubscribe,f=d._subscriptions;if(this._subscriptions=null,isFunction_1.isFunction(e)){var g=tryCatch_1.tryCatch(e).call(this);g===errorObject_1.errorObject&&(b=!0,(c=c||[]).push(errorObject_1.errorObject.e))}if(isArray_1.isArray(f))for(var j,h=-1,i=f.length;++h<i;)if(j=f[h],isObject_1.isObject(j)){var g=tryCatch_1.tryCatch(j.unsubscribe).call(j);if(g===errorObject_1.errorObject){b=!0,c=c||[];var k=errorObject_1.errorObject.e;k instanceof UnsubscriptionError_1.UnsubscriptionError?c=c.concat(k.errors):c.push(k)}}if(b)throw new UnsubscriptionError_1.UnsubscriptionError(c)}},a.prototype.add=function(b){if(!b||b===a.EMPTY)return a.EMPTY;if(b===this)return this;var c=b;switch(typeof b){case'function':c=new a(b);case'object':if(c.closed||'function'!=typeof c.unsubscribe)break;else this.closed?c.unsubscribe():(this._subscriptions||(this._subscriptions=[])).push(c);break;default:throw new Error('unrecognized teardown '+b+' added to Subscription.');}return c},a.prototype.remove=function(b){if(null!=b&&b!==this&&b!==a.EMPTY){var c=this._subscriptions;if(c){var d=c.indexOf(b);-1!==d&&c.splice(d,1)}}},a.EMPTY=function(b){return b.closed=!0,b}(new a),a}();exports.Subscription=Subscription;