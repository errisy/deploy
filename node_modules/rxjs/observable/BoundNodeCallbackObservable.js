"use strict";var __extends=function(a,c){function e(){this.constructor=a}for(var f in c)c.hasOwnProperty(f)&&(a[f]=c[f]);a.prototype=null===c?Object.create(c):(e.prototype=c.prototype,new e)},Observable_1=require("rxjs/Observable"),tryCatch_1=require("rxjs/util/tryCatch"),errorObject_1=require("rxjs/util/errorObject"),AsyncSubject_1=require("rxjs/AsyncSubject"),BoundNodeCallbackObservable=function(a){function c(e,f,g,h){a.call(this),this.callbackFunc=e,this.selector=f,this.args=g,this.scheduler=h}return __extends(c,a),c.create=function(e,f,g){return void 0===f&&(f=void 0),function(){for(var h=[],i=0;i<arguments.length;i++)h[i-0]=arguments[i];return new c(e,f,h,g)}},c.prototype._subscribe=function(e){var f=this.callbackFunc,g=this.args,h=this.scheduler,i=this.subject;if(!h){if(!i){i=this.subject=new AsyncSubject_1.AsyncSubject;var j=function l(){for(var m=[],n=0;n<arguments.length;n++)m[n-0]=arguments[n];var o=l.source,q=o.selector,r=o.subject,s=m.shift();if(s)r.error(s);else if(q){var t=tryCatch_1.tryCatch(q).apply(this,m);t===errorObject_1.errorObject?r.error(errorObject_1.errorObject.e):(r.next(t),r.complete())}else r.next(1===m.length?m[0]:m),r.complete()};j.source=this;var k=tryCatch_1.tryCatch(f).apply(this,g.concat(j));k===errorObject_1.errorObject&&i.error(errorObject_1.errorObject.e)}return i.subscribe(e)}return h.schedule(dispatch,0,{source:this,subscriber:e})},c}(Observable_1.Observable);exports.BoundNodeCallbackObservable=BoundNodeCallbackObservable;function dispatch(a){var c=this,e=a.source,f=a.subscriber,g=e,h=g.callbackFunc,i=g.args,j=g.scheduler,k=e.subject;if(!k){k=e.subject=new AsyncSubject_1.AsyncSubject;var l=function n(){for(var o=[],q=0;q<arguments.length;q++)o[q-0]=arguments[q];var r=n.source,s=r.selector,t=r.subject,u=o.shift();if(u)t.error(u);else if(s){var v=tryCatch_1.tryCatch(s).apply(this,o);v===errorObject_1.errorObject?c.add(j.schedule(dispatchError,0,{err:errorObject_1.errorObject.e,subject:t})):c.add(j.schedule(dispatchNext,0,{value:v,subject:t}))}else{var w=1===o.length?o[0]:o;c.add(j.schedule(dispatchNext,0,{value:w,subject:t}))}};l.source=e;var m=tryCatch_1.tryCatch(h).apply(this,i.concat(l));m===errorObject_1.errorObject&&k.error(errorObject_1.errorObject.e)}c.add(k.subscribe(f))}function dispatchNext(a){var c=a.value,e=a.subject;e.next(c),e.complete()}function dispatchError(a){var c=a.err,e=a.subject;e.error(c)}