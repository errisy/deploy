'use strict';var Observable_1=require('../Observable'),ReplaySubject_1=require('../ReplaySubject');function cache(a,b,c){void 0===a&&(a=Number.POSITIVE_INFINITY),void 0===b&&(b=Number.POSITIVE_INFINITY);var d,e=this,f=0,g,h=function(){return d=new ReplaySubject_1.ReplaySubject(a,b,c),d};return new Observable_1.Observable(function(i){d||(d=h(),g=e.subscribe(function(k){return d.next(k)},function(k){var l=d;d=null,l.error(k)},function(){return d.complete()})),f++,d||(d=h());var j=d.subscribe(i);return function(){f--,j&&j.unsubscribe(),0==f&&g.unsubscribe()}})}exports.cache=cache;