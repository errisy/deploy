"use strict";var __extends=function(a,c){function e(){this.constructor=a}for(var f in c)c.hasOwnProperty(f)&&(a[f]=c[f]);a.prototype=null===c?Object.create(c):(e.prototype=c.prototype,new e)},OuterSubscriber_1=require("rxjs/OuterSubscriber"),subscribeToResult_1=require("rxjs/util/subscribeToResult");function mergeMapTo(a,c,e){return void 0===e&&(e=Number.POSITIVE_INFINITY),"number"==typeof c&&(e=c,c=null),this.lift(new MergeMapToOperator(a,c,e))}exports.mergeMapTo=mergeMapTo;var MergeMapToOperator=function(){function a(c,e,f){void 0===f&&(f=Number.POSITIVE_INFINITY),this.ish=c,this.resultSelector=e,this.concurrent=f}return a.prototype.call=function(c,e){return e._subscribe(new MergeMapToSubscriber(c,this.ish,this.resultSelector,this.concurrent))},a}();exports.MergeMapToOperator=MergeMapToOperator;var MergeMapToSubscriber=function(a){function c(e,f,g,h){void 0===h&&(h=Number.POSITIVE_INFINITY),a.call(this,e),this.ish=f,this.resultSelector=g,this.concurrent=h,this.hasCompleted=!1,this.buffer=[],this.active=0,this.index=0}return __extends(c,a),c.prototype._next=function(e){if(this.active<this.concurrent){var f=this.resultSelector,g=this.index++,h=this.ish,i=this.destination;this.active++,this._innerSub(h,i,f,e,g)}else this.buffer.push(e)},c.prototype._innerSub=function(e,f,g,h,i){this.add(subscribeToResult_1.subscribeToResult(this,e,h,i))},c.prototype._complete=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete()},c.prototype.notifyNext=function(e,f,g,h){var j=this,k=j.resultSelector,l=j.destination;k?this.trySelectResult(e,f,g,h):l.next(f)},c.prototype.trySelectResult=function(e,f,g,h){var l,i=this,j=i.resultSelector,k=i.destination;try{l=j(e,f,g,h)}catch(m){return void k.error(m)}k.next(l)},c.prototype.notifyError=function(e){this.destination.error(e)},c.prototype.notifyComplete=function(e){var f=this.buffer;this.remove(e),this.active--,0<f.length?this._next(f.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()},c}(OuterSubscriber_1.OuterSubscriber);exports.MergeMapToSubscriber=MergeMapToSubscriber;