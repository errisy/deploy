"use strict";var __extends=function(a,c){function e(){this.constructor=a}for(var f in c)c.hasOwnProperty(f)&&(a[f]=c[f]);a.prototype=null===c?Object.create(c):(e.prototype=c.prototype,new e)},tryCatch_1=require("rxjs/util/tryCatch"),errorObject_1=require("rxjs/util/errorObject"),subscribeToResult_1=require("rxjs/util/subscribeToResult"),OuterSubscriber_1=require("rxjs/OuterSubscriber");function mergeScan(a,c,e){return void 0===e&&(e=Number.POSITIVE_INFINITY),this.lift(new MergeScanOperator(a,c,e))}exports.mergeScan=mergeScan;var MergeScanOperator=function(){function a(c,e,f){this.project=c,this.seed=e,this.concurrent=f}return a.prototype.call=function(c,e){return e._subscribe(new MergeScanSubscriber(c,this.project,this.seed,this.concurrent))},a}();exports.MergeScanOperator=MergeScanOperator;var MergeScanSubscriber=function(a){function c(e,f,g,h){a.call(this,e),this.project=f,this.acc=g,this.concurrent=h,this.hasValue=!1,this.hasCompleted=!1,this.buffer=[],this.active=0,this.index=0}return __extends(c,a),c.prototype._next=function(e){if(this.active<this.concurrent){var f=this.index++,g=tryCatch_1.tryCatch(this.project)(this.acc,e),h=this.destination;g===errorObject_1.errorObject?h.error(errorObject_1.errorObject.e):(this.active++,this._innerSub(g,e,f))}else this.buffer.push(e)},c.prototype._innerSub=function(e,f,g){this.add(subscribeToResult_1.subscribeToResult(this,e,f,g))},c.prototype._complete=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&(!1===this.hasValue&&this.destination.next(this.acc),this.destination.complete())},c.prototype.notifyNext=function(e,f){var j=this.destination;this.acc=f,this.hasValue=!0,j.next(f)},c.prototype.notifyComplete=function(e){var f=this.buffer;this.remove(e),this.active--,0<f.length?this._next(f.shift()):0===this.active&&this.hasCompleted&&(!1===this.hasValue&&this.destination.next(this.acc),this.destination.complete())},c}(OuterSubscriber_1.OuterSubscriber);exports.MergeScanSubscriber=MergeScanSubscriber;