"use strict";var __extends=function(a,c){function e(){this.constructor=a}for(var f in c)c.hasOwnProperty(f)&&(a[f]=c[f]);a.prototype=null===c?Object.create(c):(e.prototype=c.prototype,new e)},Subject_1=require("rxjs/Subject"),tryCatch_1=require("rxjs/util/tryCatch"),errorObject_1=require("rxjs/util/errorObject"),OuterSubscriber_1=require("rxjs/OuterSubscriber"),subscribeToResult_1=require("rxjs/util/subscribeToResult");function retryWhen(a){return this.lift(new RetryWhenOperator(a,this))}exports.retryWhen=retryWhen;var RetryWhenOperator=function(){function a(c,e){this.notifier=c,this.source=e}return a.prototype.call=function(c,e){return e._subscribe(new RetryWhenSubscriber(c,this.notifier,this.source))},a}(),RetryWhenSubscriber=function(a){function c(e,f,g){a.call(this,e),this.notifier=f,this.source=g}return __extends(c,a),c.prototype.error=function(e){if(!this.isStopped){var f=this.errors,g=this.retries,h=this.retriesSubscription;if(!g){if(f=new Subject_1.Subject,g=tryCatch_1.tryCatch(this.notifier)(f),g===errorObject_1.errorObject)return a.prototype.error.call(this,errorObject_1.errorObject.e);h=subscribeToResult_1.subscribeToResult(this,g)}else this.errors=null,this.retriesSubscription=null;this.unsubscribe(),this.closed=!1,this.errors=f,this.retries=g,this.retriesSubscription=h,f.next(e)}},c.prototype._unsubscribe=function(){var e=this,f=e.errors,g=e.retriesSubscription;f&&(f.unsubscribe(),this.errors=null),g&&(g.unsubscribe(),this.retriesSubscription=null),this.retries=null},c.prototype.notifyNext=function(){var j=this,k=j.errors,l=j.retries,m=j.retriesSubscription;this.errors=null,this.retries=null,this.retriesSubscription=null,this.unsubscribe(),this.isStopped=!1,this.closed=!1,this.errors=k,this.retries=l,this.retriesSubscription=m,this.source.subscribe(this)},c}(OuterSubscriber_1.OuterSubscriber);