'use strict';var __extends=this&&this.__extends||function(a,c){function e(){this.constructor=a}for(var f in c)c.hasOwnProperty(f)&&(a[f]=c[f]);a.prototype=null===c?Object.create(c):(e.prototype=c.prototype,new e)},ArrayObservable_1=require('../observable/ArrayObservable'),isArray_1=require('../util/isArray'),Subscriber_1=require('../Subscriber'),OuterSubscriber_1=require('../OuterSubscriber'),subscribeToResult_1=require('../util/subscribeToResult'),iterator_1=require('../symbol/iterator');function zipProto(){for(var a=[],c=0;c<arguments.length;c++)a[c-0]=arguments[c];return a.unshift(this),zipStatic.apply(this,a)}exports.zipProto=zipProto;function zipStatic(){for(var a=[],c=0;c<arguments.length;c++)a[c-0]=arguments[c];var e=a[a.length-1];return'function'==typeof e&&a.pop(),new ArrayObservable_1.ArrayObservable(a).lift(new ZipOperator(e))}exports.zipStatic=zipStatic;var ZipOperator=function(){function a(c){this.project=c}return a.prototype.call=function(c,e){return e._subscribe(new ZipSubscriber(c,this.project))},a}();exports.ZipOperator=ZipOperator;var ZipSubscriber=function(a){function c(e,f,g){void 0===g&&(g=Object.create(null)),a.call(this,e),this.index=0,this.iterators=[],this.active=0,this.project='function'==typeof f?f:null,this.values=g}return __extends(c,a),c.prototype._next=function(e){var f=this.iterators,g=this.index++;isArray_1.isArray(e)?f.push(new StaticArrayIterator(e)):'function'==typeof e[iterator_1.$$iterator]?f.push(new StaticIterator(e[iterator_1.$$iterator]())):f.push(new ZipBufferIterator(this.destination,this,e,g))},c.prototype._complete=function(){var e=this.iterators,f=e.length;this.active=f;for(var h,g=0;g<f;g++)h=e[g],h.stillUnsubscribed?this.add(h.subscribe(h,g)):this.active--},c.prototype.notifyInactive=function(){this.active--,0===this.active&&this.destination.complete()},c.prototype.checkIterators=function(){for(var j,e=this.iterators,f=e.length,g=this.destination,h=0;h<f;h++)if(j=e[h],'function'==typeof j.hasValue&&!j.hasValue())return;for(var k=!1,l=[],h=0;h<f;h++){var j=e[h],m=j.next();if(j.hasCompleted()&&(k=!0),m.done)return void g.complete();l.push(m.value)}this.project?this._tryProject(l):g.next(l),k&&g.complete()},c.prototype._tryProject=function(e){var f;try{f=this.project.apply(this,e)}catch(g){return void this.destination.error(g)}this.destination.next(f)},c}(Subscriber_1.Subscriber);exports.ZipSubscriber=ZipSubscriber;var StaticIterator=function(){function a(c){this.iterator=c,this.nextResult=c.next()}return a.prototype.hasValue=function(){return!0},a.prototype.next=function(){var c=this.nextResult;return this.nextResult=this.iterator.next(),c},a.prototype.hasCompleted=function(){var c=this.nextResult;return c&&c.done},a}(),StaticArrayIterator=function(){function a(c){this.array=c,this.index=0,this.length=0,this.length=c.length}return a.prototype[iterator_1.$$iterator]=function(){return this},a.prototype.next=function(){var e=this.index++,f=this.array;return e<this.length?{value:f[e],done:!1}:{value:null,done:!0}},a.prototype.hasValue=function(){return this.array.length>this.index},a.prototype.hasCompleted=function(){return this.array.length===this.index},a}(),ZipBufferIterator=function(a){function c(e,f,g,h){a.call(this,e),this.parent=f,this.observable=g,this.index=h,this.stillUnsubscribed=!0,this.buffer=[],this.isComplete=!1}return __extends(c,a),c.prototype[iterator_1.$$iterator]=function(){return this},c.prototype.next=function(){var e=this.buffer;return 0===e.length&&this.isComplete?{value:null,done:!0}:{value:e.shift(),done:!1}},c.prototype.hasValue=function(){return 0<this.buffer.length},c.prototype.hasCompleted=function(){return 0===this.buffer.length&&this.isComplete},c.prototype.notifyComplete=function(){0<this.buffer.length?(this.isComplete=!0,this.parent.notifyInactive()):this.destination.complete()},c.prototype.notifyNext=function(e,f){this.buffer.push(f),this.parent.checkIterators()},c.prototype.subscribe=function(e,f){return subscribeToResult_1.subscribeToResult(this,this.observable,this,f)},c}(OuterSubscriber_1.OuterSubscriber);